<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>รวมสรุปบทเรียน 11–22 — Estimation &amp; Inference</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="assets/css/summary.css">
  <link rel="stylesheet" href="print.css" media="print">
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']],
        displayMath: [['\\[', '\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="assets/js/reading-tools.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="mathjax-script" async></script>
  <script type="application/json" id="summary-meta">
    {
      "id": "summary-lesson11-22",
      "lesson": "lesson11-22",
      "title": "รวมสรุปบทเรียน 11–22 — Estimation &amp; Inference",
      "version": "1.0.0",
      "updated_at": "2025-01-15",
      "depends_on": [
        "assets/css/summary.css",
        "style.css",
        "assets/js/reading-tools.js"
      ]
    }
  </script>
</head>
<body class="summary-page summary-page--catalog">
  <header>
    <h1>รวมสรุปบทเรียน 11–22</h1>
    <p>อ่านเนื้อหา Estimation และ Hypothesis Testing ที่ขยายใหม่ทั้งหมดในหน้าเดียว — พร้อมสูตร, แบบฝึกหัด, และสรุป 1 หน้า</p>
  </header>

  <nav class="toc" aria-label="Table of contents">
    <h2>เลือกกระโดดไปยังบทที่ต้องการ</h2>
    <ul class="toc-list" id="toc-list"></ul>
  </nav>

  <p class="loading" id="loading">กำลังรวบรวมเนื้อหาจากบทสรุปแต่ละไฟล์…</p>
  <div class="error" id="error" hidden>เกิดข้อผิดพลาดในการดึงบางบท กรุณารีเฟรชหน้าหรือเปิดไฟล์สรุปแยกตามบทแทน</div>

  <main id="lesson-compilation" hidden></main>

  <script>
    const lessons = [
      { id: 11, file: 'summary-lesson11.html', label: 'บทที่ 11 — การประมาณค่า' },
      { id: 12, file: 'summary-lesson12.html', label: 'บทที่ 12 — ช่วงความเชื่อมั่น' },
      { id: 13, file: 'summary-lesson13.html', label: 'บทที่ 13 — ค่าเฉลี่ย 1 กลุ่ม' },
      { id: 14, file: 'summary-lesson14.html', label: 'บทที่ 14 — สัดส่วน 1 กลุ่ม' },
      { id: 15, file: 'summary-lesson15.html', label: 'บทที่ 15 — เปรียบเทียบ 2 กลุ่ม' },
      { id: 16, file: 'summary-lesson16.html', label: 'บทที่ 16 — ขนาดตัวอย่าง' },
      { id: 17, file: 'summary-lesson17.html', label: 'บทที่ 17 — พื้นฐานสมมติฐาน' },
      { id: 18, file: 'summary-lesson18.html', label: 'บทที่ 18 — ประเภทการทดสอบ' },
      { id: 19, file: 'summary-lesson19.html', label: 'บทที่ 19 — ทดสอบค่าเฉลี่ย' },
      { id: 20, file: 'summary-lesson20.html', label: 'บทที่ 20 — ทดสอบสัดส่วน' },
      { id: 21, file: 'summary-lesson21.html', label: 'บทที่ 21 — เปรียบเทียบ 2 ประชากร' },
      { id: 22, file: 'summary-lesson22.html', label: 'บทที่ 22 — ความแปรปรวน' }
    ];

    const lessonContainer = document.getElementById('lesson-compilation');
    const tocList = document.getElementById('toc-list');
    const loadingEl = document.getElementById('loading');
    const errorEl = document.getElementById('error');

    function buildTOC() {
      const frag = document.createDocumentFragment();
      lessons.forEach(lesson => {
        const li = document.createElement('li');
        const link = document.createElement('a');
        link.href = `#lesson-${lesson.id}`;
        const number = document.createElement('span');
        number.textContent = `บทที่ ${lesson.id}`;
        const textNode = document.createElement('span');
        textNode.textContent = lesson.label.replace(/^บทที่ \d+ —\s*/, '');
        link.append(number, textNode);
        li.appendChild(link);
        frag.appendChild(li);
      });
      tocList.appendChild(frag);
    }

    async function loadLessons() {
      buildTOC();
      const fragment = document.createDocumentFragment();
      let hasContent = false;
      let hadError = false;
      for (const lesson of lessons) {
        try {
          const response = await fetch(lesson.file);
          if (!response.ok) {
            throw new Error(`โหลดไม่สำเร็จ: ${lesson.file}`);
          }
          const html = await response.text();
          const doc = new DOMParser().parseFromString(html, 'text/html');
          const header = doc.querySelector('header');
          const main = doc.querySelector('main');
          const footer = doc.querySelector('footer');

          const article = document.createElement('article');
          article.id = `lesson-${lesson.id}`;

          if (header) {
            const importedHeader = document.importNode(header, true);
            const title = importedHeader.querySelector('h1');
            if (title) {
              const newTitle = document.createElement('h2');
              newTitle.innerHTML = title.innerHTML;
              importedHeader.replaceChild(newTitle, title);
            }
            article.appendChild(importedHeader);
          } else {
            const fallbackHeader = document.createElement('header');
            const h2 = document.createElement('h2');
            h2.textContent = lesson.label;
            fallbackHeader.appendChild(h2);
            article.appendChild(fallbackHeader);
          }

          const lessonBody = document.createElement('div');
          lessonBody.className = 'lesson-body';

          if (main) {
            const importedMain = document.importNode(main, true);
            Array.from(importedMain.children).forEach(section => {
              lessonBody.appendChild(section);
            });
          }

          if (footer) {
            const importedFooter = document.importNode(footer, true);
            lessonBody.appendChild(importedFooter);
          }

          article.appendChild(lessonBody);
          fragment.appendChild(article);
          hasContent = true;
        } catch (err) {
          console.error(err);
          hadError = true;
        }
      }
      if (hasContent) {
        lessonContainer.appendChild(fragment);
        lessonContainer.hidden = false;
        loadingEl.hidden = true;
        errorEl.hidden = !hadError;
        if (window.MathJax?.typesetPromise) {
          MathJax.typesetPromise();
        }
      } else {
        loadingEl.hidden = true;
        errorEl.hidden = false;
      }
    }

    loadLessons();
  </script>
</body>
</html>
