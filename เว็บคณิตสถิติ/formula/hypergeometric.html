<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Hypergeometric Distribution | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏π‡∏ï‡∏£ + ‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î C(a,b)</title>
  <meta name="description" content="‡∏™‡∏π‡∏ï‡∏£ Hypergeometric: PMF, E, Var ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡πÄ‡∏•‡∏Ç ‡πÅ‡∏•‡∏∞‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì C(a,b) (‡∏¢‡πà‡∏≠‡πÄ‡∏®‡∏©‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô)">
  <meta property="og:title" content="Hypergeometric Distribution | ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏π‡∏ï‡∏£ + ‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î C(a,b)">
  <meta property="og:description" content="‡∏™‡∏∏‡πà‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô + ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÄ‡∏ô‡∏ä‡∏±‡∏ô C(a,b) ‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡πÄ‡∏®‡∏©‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô">
  <meta name="doc:version" content="1.0.0">
  <meta name="doc:updated_at" content="2025-10-02">
  <meta name="doc:depends_on" content="lesson07.html,summary-lesson07.html,glossary.html#gl-dist">

  <link rel="stylesheet" href="../style.css">
  <link rel="stylesheet" href="../print.css" media="print">

  <style>
    .wrap{max-width:1020px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    @media(max-width:900px){.grid2{grid-template-columns:1fr}}
    .formula-box{background:#0f1320;border:1px solid var(--border);border-radius:12px;padding:.8rem;overflow:auto}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    table{width:100%;border-collapse:collapse;margin:.4rem 0}
    th,td{border:1px solid var(--border);padding:.45rem .5rem;text-align:center}
    th{background:#101525}
    .ok{background:#0f231c;border-left:4px solid var(--ok);padding:.6rem;border-radius:12px}
    .warn{background:#231b0f;border-left:4px solid var(--warn);padding:.6rem;border-radius:12px}
    .toolbar{display:flex;gap:.5rem;flex-wrap:wrap}
    .mini{font-size:.9rem}
    .calc-row{display:flex;gap:.6rem;flex-wrap:wrap;align-items:center}
    input[type="number"]{
      width:120px;background:#0b0f19;border:1px solid var(--border);border-radius:10px;color:#e8e8ea;padding:.45rem .55rem;
    }
    select{
      background:#0b0f19;border:1px solid var(--border);border-radius:10px;color:#e8e8ea;padding:.45rem .55rem;
    }
    canvas{width:100%;height:240px;background:#0c111b;border:1px solid var(--border);border-radius:12px}
    .badge{display:inline-block;border:1px solid var(--border);padding:.2rem .5rem;border-radius:999px;background:#0e1220;color:#cfe0ff;margin-left:.35rem}
    .list-compact{margin:.2rem 0 0 .8rem}
    .step{margin:.25rem 0}
    .pill{display:inline-block;padding:.15rem .5rem;border:1px solid var(--border);border-radius:999px;background:#0e1220;color:#cfe0ff;font-size:.85rem;margin-left:.4rem}
    .tag{display:inline-block;margin:.2rem .2rem 0 0;padding:.15rem .5rem;border-radius:999px;border:1px solid var(--border);background:#0e1220;color:#cfe0ff;font-size:.85rem}
    .accent{color:#cfe0ff}
  </style>
</head>
<body>
  <header role="banner">
    <div class="wrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>Formula Explorer</h1>
      </div>
      <nav class="breadcrumb" aria-label="breadcrumb">
        <a href="../index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a> ‚Ä∫ <span class="muted">Hypergeometric</span>
      </nav>
      <div class="title" style="display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;flex-wrap:wrap;padding:.6rem 0 1.0rem">
        <div>
          <h2 style="margin:.2rem 0;font-size:1.8rem">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡πÅ‡∏ö‡∏ö‡πÑ‡∏Æ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏à‡∏µ‡∏≠‡∏≠‡πÄ‡∏°‡∏ï‡∏£‡∏¥‡∏Ñ (Hypergeometric)</h2>
          <p class="muted">‡∏™‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î <strong>‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô</strong> : ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏´‡∏¢‡∏¥‡∏ö‡πÑ‡∏î‡πâ ‚Äú‡∏Ç‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‚Äù k ‡∏ä‡∏¥‡πâ‡∏ô</p>
        </div>
        <div class="toolbar">
          <a class="btn secondary" href="../glossary.html">Glossary</a>
          <a class="btn ghost" href="../lesson07.html">‡∏ö‡∏ó‡∏ó‡∏µ‡πà 7</a>
          <a class="btn ghost" href="../summary-lesson07.html">‡∏™‡∏£‡∏∏‡∏õ 1 ‡∏´‡∏ô‡πâ‡∏≤</a>
          <button class="btn" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå/‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å PDF</button>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap grid" role="main">
    <section class="card">
      <h3>1) ‡∏ó‡∏µ‡πà‡∏°‡∏≤ (Intuition) &amp; ‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</h3>
      <p>‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ <strong>N</strong> ‡∏ä‡∏¥‡πâ‡∏ô (‡∏à‡∏≥‡∏Å‡∏±‡∏î) ‡∏ó‡∏µ‡πà‡∏°‡∏µ ‚Äú‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‚Äù <strong>K</strong> ‡∏ä‡∏¥‡πâ‡∏ô ‡∏´‡∏¢‡∏¥‡∏ö‡∏°‡∏≤ <strong>n</strong> ‡∏ä‡∏¥‡πâ‡∏ô <em>‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô</em> ‚Üí ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à <strong>k</strong> ‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö Hypergeometric</p>
      <ul class="list-compact">
        <li>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡πÅ‡∏î‡∏á (‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à) K ‡∏•‡∏π‡∏Å + ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏Ç‡∏≤‡∏ß (‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à) (N‚àíK) ‡∏•‡∏π‡∏Å ‡∏´‡∏¢‡∏¥‡∏ö‡∏ó‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß n ‡∏•‡∏π‡∏Å</li>
        <li>‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å Binomial: <em>Binomial</em> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏™‡∏∏‡πà‡∏°‡πÅ‡∏ö‡∏ö <strong>‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô</strong> ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å</li>
      </ul>
    </section>

    <section class="card grid2">
      <div>
        <h3>2) ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå/‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</h3>
        <ul class="list-compact">
          <li><strong>N</strong> = ‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
          <li><strong>K</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‚Äú‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‚Äù ‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</li>
          <li><strong>n</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏¥‡∏ö</li>
          <li><strong>k</strong> = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏µ‡πà‡∏´‡∏¢‡∏¥‡∏ö‡πÑ‡∏î‡πâ</li>
        </ul>
        <p class="mini muted">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: 0 ‚â§ K ‚â§ N, 0 ‚â§ n ‚â§ N ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á k ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠ 4</p>
      </div>
      <div>
        <h3>3) ‡∏™‡∏π‡∏ï‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
        <div class="formula-box mono">
          PMF: P(X = k) = [ C(K, k) ¬∑ C(N ‚àí K, n ‚àí k) ] / C(N, n)<br/>
          E[X] = n ¬∑ (K / N) &nbsp;&nbsp;|&nbsp;&nbsp;
          Var(X) = n ¬∑ (K/N) ¬∑ (1 ‚àí K/N) ¬∑ ((N ‚àí n) / (N ‚àí 1))
        </div>
        <div class="mini muted">C(a,b) = ‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÄ‡∏ô‡∏ä‡∏±‡∏ô ‚Äú‡πÄ‡∏•‡∏∑‡∏≠‡∏Å b ‡∏à‡∏≤‡∏Å a‚Äù</div>
      </div>
    </section>

    <section class="card">
      <h3>4) ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏Ç‡∏≠‡∏á k</h3>
      <div class="formula-box mono">k ‚àà { max(0, n ‚àí (N ‚àí K)), ‚Ä¶ , min(n, K) }</div>
      <p class="mini muted">‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ min(n, K); ‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏µ‡∏Å‡∏™‡∏µ (N‚àíK) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏¥‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á</p>
    </section>

    <!-- ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Hypergeometric -->
    <section class="card">
      <h3>5) ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡πÄ‡∏•‡∏Ç Hypergeometric üßÆ <span class="badge">Interactive</span></h3>
      <div class="calc-row" style="margin:.35rem 0 .5rem">
        <label for="N">N (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î):</label>
        <input id="N" type="number" min="1" step="1" value="20">
        <label for="K">K (‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à):</label>
        <input id="K" type="number" min="0" step="1" value="7">
        <label for="n">n (‡∏´‡∏¢‡∏¥‡∏ö):</label>
        <input id="n" type="number" min="0" step="1" value="5">
        <label for="k">k (‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£):</label>
        <select id="k"></select>
        <button class="btn" id="btn-calc">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
        <button class="btn secondary" id="btn-reset">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <span class="mini muted" id="status" aria-live="polite"></span>
      </div>

      <div class="grid2">
        <div>
          <table aria-label="‡∏ï‡∏≤‡∏£‡∏≤‡∏á PMF Hypergeometric">
            <thead>
              <tr><th>k</th><th>P(X=k)</th></tr>
            </thead>
            <tbody id="pmf-rows"></tbody>
            <tfoot>
              <tr><th>‡∏£‡∏ß‡∏°</th><th id="sum">‚Äî</th></tr>
            </tfoot>
          </table>
          <p class="mini muted">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏™‡∏£‡∏∏‡∏õ: <span id="stats">E[X]=‚Äî, Var(X)=‚Äî, SD=‚Äî</span></p>
          <p class="mini">P(X=<span id="k-show">‚Äî</span>) = <span id="pmf-k">‚Äî</span> <span class="pill" id="domain-pill" aria-live="polite"></span></p>
        </div>
        <div>
          <canvas id="chart" aria-label="‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á PMF Hypergeometric"></canvas>
        </div>
      </div>

      <div class="warn" style="margin-top:.6rem">
        <strong>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:</strong> ‡∏ñ‡πâ‡∏≤ N ‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å (‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô) ‚Üí <a href="./binomial.html">Binomial</a>; ‡πÉ‡∏ô‡∏ö‡∏≤‡∏á‡∏Å‡∏£‡∏ì‡∏µ Binomial ‡∏≠‡∏≤‡∏à‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏î‡πâ‡∏ß‡∏¢ <a href="./poisson.html">Poisson</a>
      </div>
    </section>

    <!-- ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥ & ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á -->
    <section class="card grid2">
      <div>
        <h3>6) ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå (Workflow)</h3>
        <ol>
          <li class="step">‡∏ô‡∏¥‡∏¢‡∏≤‡∏° N, K, n ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå</li>
          <li class="step">‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡πà‡∏ß‡∏á‡∏Ç‡∏≠‡∏á k: <span class="mono">max(0, n ‚àí (N ‚àí K)) ‚Ä¶ min(n, K)</span></li>
          <li class="step">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì PMF: <span class="mono">[C(K,k)¬∑C(N‚àíK,n‚àík)] / C(N,n)</span></li>
          <li class="step">‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ E/Var ‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏™‡∏£‡∏∏‡∏õ</li>
        </ol>
        <div class="ok" style="margin-top:.4rem">
          <strong>‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏™‡∏±‡πâ‡∏ô ‡πÜ:</strong> ‡∏ï‡∏±‡∏ß‡πÄ‡∏®‡∏© = ‡∏ß‡∏¥‡∏ò‡∏µ ‚Äú‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à k‚Äù √ó ‡∏ß‡∏¥‡∏ò‡∏µ ‚Äú‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à n‚àík‚Äù; ‡∏ï‡∏±‡∏ß‡∏™‡πà‡∏ß‡∏ô = ‡∏ß‡∏¥‡∏ò‡∏µ‡∏´‡∏¢‡∏¥‡∏ö n ‡∏à‡∏≤‡∏Å N
        </div>
      </div>
      <div>
        <h3>7) ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h3>
        <p><strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</strong> N=20, K=7, n=5 ‡∏´‡∏≤ P(X=2)</p>
        <ol class="list-compact">
          <li>‡∏ä‡πà‡∏ß‡∏á k: <span class="mono">0‚Ä¶5</span></li>
          <li>PMF: <span class="mono">P(X=2) = [C(7,2)¬∑C(13,3)] / C(20,5)</span></li>
          <li>‡∏Ñ‡πà‡∏≤: <span class="mono">C(7,2)=21, C(13,3)=286, C(20,5)=15504</span> ‚áí P ‚âà 0.387</li>
        </ol>
        <div class="toolbar" style="margin-top:.4rem">
          <button class="btn ghost" id="btn-step-Ckk">‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î C(K,k)</button>
          <button class="btn ghost" id="btn-step-Cnk">‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î C(N‚àíK, n‚àík)</button>
          <button class="btn ghost" id="btn-step-CNn">‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î C(N, n)</button>
        </div>
      </div>
    </section>

    <!-- ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÄ‡∏ô‡∏ä‡∏±‡∏ô -->
    <section class="card">
      <h3>8) ‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì <span class="mono">C(a,b)</span> üß© <span class="badge">Interactive</span></h3>
      <p class="mini muted">‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏π‡∏ì‡∏ó‡∏µ‡∏•‡∏∞‡∏û‡∏à‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡πÄ‡∏®‡∏©‡∏™‡πà‡∏ß‡∏ô‡∏î‡πâ‡∏ß‡∏¢ <span class="mono">gcd</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏û‡∏≠‡∏á‡πÇ‡∏ï</p>

      <div class="calc-row" style="margin:.35rem 0 .5rem">
        <label for="a">a:</label><input id="a" type="number" min="0" step="1" value="20">
        <label for="b">b:</label><input id="b" type="number" min="0" step="1" value="5">
        <button class="btn" id="btn-steps">‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î</button>
        <button class="btn secondary" id="btn-steps-reset">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        <span class="mini muted" id="steps-status" aria-live="polite"></span>
      </div>

      <div class="formula-box mono" id="steps-head">C(20,5) = ?</div>
      <div class="mini" id="prod-view"></div>

      <table aria-label="‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏Ñ‡∏≠‡∏°‡∏ö‡∏¥‡πÄ‡∏ô‡∏ä‡∏±‡∏ô" id="steps-table">
        <thead>
          <tr>
            <th>‡∏Ç‡∏±‡πâ‡∏ô</th>
            <th>‡∏û‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏®‡∏©</th>
            <th>‡∏û‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏™‡πà‡∏ß‡∏ô</th>
            <th>gcd</th>
            <th>‡πÄ‡∏®‡∏©‡∏´‡∏•‡∏±‡∏á‡∏¢‡πà‡∏≠</th>
            <th>‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏¢‡πà‡∏≠</th>
            <th>‡∏Ñ‡∏π‡∏ì‡∏™‡∏∞‡∏™‡∏° (num)</th>
            <th>‡∏Ñ‡∏π‡∏ì‡∏™‡∏∞‡∏™‡∏° (den)</th>
            <th>‡∏Ñ‡πà‡∏≤ ‡∏ì ‡∏Ç‡∏±‡πâ‡∏ô‡∏ô‡∏µ‡πâ</th>
          </tr>
        </thead>
        <tbody></tbody>
        <tfoot>
          <tr>
            <th colspan="8" style="text-align:right">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</th>
            <th id="steps-final">‚Äî</th>
          </tr>
        </tfoot>
      </table>

      <div class="mini muted" style="margin-top:.4rem">
        ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£ <span class="mono">C(n,r) = ‚àè<sub>i=1..r</sub> (n‚àír+i)/i</span> ‡πÅ‡∏•‡∏∞ <span class="mono">r = min(r, n‚àír)</span> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏π‡∏ì/‡∏´‡∏≤‡∏£‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
      </div>
    </section>

    <section class="card grid2">
      <div>
        <h3>9) ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</h3>
        <div class="toolbar">
          <a class="btn ghost" href="./binomial.html">Binomial</a>
          <a class="btn ghost" href="./poisson.html">Poisson</a>
          <a class="btn ghost" href="./z-score.html">Z-Score</a>
          <a class="btn ghost" href="./clt-xbar-phat.html">CLT: xÃÑ &amp; pÃÇ</a>
        </div>
      </div>
      <div>
        <h3>10) ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
        <ul class="list-compact">
          <li>‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û/‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏•‡πá‡∏≠‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î</li>
          <li>‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏õ‡∏£‡∏õ‡∏£‡∏ß‡∏ô <span class="mono">(N‚àín)/(N‚àí1)</span> ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Ñ‡∏∑‡∏ô</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="wrap" role="contentinfo" style="border-top:1px solid var(--border);margin-top:1rem;padding-top:.8rem">
    <div class="muted">¬© ‡∏Ñ‡∏≠‡∏£‡πå‡∏™‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ (‡πÑ‡∏ó‡∏¢) ‚Äî ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡πâ‡∏ß‡∏¢ <code>print.css</code></div>
  </footer>

  <script>
    // ===== Utility =====
    const gcd = (a,b)=>{a=Math.abs(a);b=Math.abs(b);while(b){const t=a%b;a=b;b=t;}return a||1;};
    const LIMIT_N = 200; // ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤/‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏Ç‡∏≠‡∏á Number
    const LIMIT_COMB = 300;
    function clampInt(v,min,max){ v = Math.round(Number(v)); if(!Number.isFinite(v)) v=min; return Math.max(min, Math.min(max, v)); }
    function readInt(el, min, max, label, notes){
      const upper = Math.max(min, max);
      let raw = Math.round(Number(el.value));
      if(!Number.isFinite(raw)){
        raw = min;
        notes?.push(`${label} ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏õ‡πá‡∏ô ${min}`);
      }
      let value = raw;
      if(value < min){
        value = min;
        notes?.push(`${label} ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ${min}`);
      }
      if(value > upper){
        value = upper;
        notes?.push(`${label} ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô ${upper}`);
      }
      el.value = value;
      return value;
    }
    function fmt(x, d=6){ if(!Number.isFinite(x)) return '‚Äî'; const rounded = Math.round(x*10**d)/10**d; const str = rounded.toFixed(d).replace(/0+$/,'').replace(/\.$/,''); return str === '' ? '0' : str; }

    // ===== Intersection animation =====
    const cards = document.querySelectorAll('.card');
    const obs = new IntersectionObserver((ents)=>{
      ents.forEach(e=>{
        if(e.isIntersecting){
          e.target.animate([{opacity:0, transform:'translateY(8px)'},{opacity:1, transform:'translateY(0)'}],
            {duration:450, easing:'ease-out', fill:'forwards'});
          obs.unobserve(e.target);
        }
      });
    }, {threshold:.12});
    cards.forEach(c=>obs.observe(c));

    // ===== Hypergeometric Calculator =====
    const NEl = document.getElementById('N');
    const KEl = document.getElementById('K');
    const nEl = document.getElementById('n');
    const kSel= document.getElementById('k');
    const statusEl = document.getElementById('status');
    const pmfRows = document.getElementById('pmf-rows');
    const sumEl = document.getElementById('sum');
    const statsEl = document.getElementById('stats');
    const pmfKEl = document.getElementById('pmf-k');
    const kShow = document.getElementById('k-show');
    const domPill = document.getElementById('domain-pill');
    const canvas = document.getElementById('chart');
    const ctx = canvas.getContext('2d');
    const btnCalc = document.getElementById('btn-calc');
    const btnReset = document.getElementById('btn-reset');

    let lastVals = [];
    let lastKMin = 0;

    function domainK(N,K,n){ const kmin = Math.max(0, n - (N - K)); const kmax = Math.min(n, K); return [kmin, kmax]; }

    function comb(n,r){
      n = Math.floor(n); r = Math.floor(r);
      if(r<0 || r>n) return 0;
      r = Math.min(r, n-r);
      if(r===0) return 1;
      let num = 1, den = 1;
      for(let i=1;i<=r;i++){
        num *= (n - r + i);
        den *= i;
        const g = gcd(num, den);
        if (g>1){ num/=g; den/=g; }
      }
      return num/den;
    }

    function hyperPMF(N,K,n,k){
      const top = comb(K,k) * comb(N-K, n-k);
      const bot = comb(N, n);
      if (bot === 0) return 0;
      return top / bot;
    }

    function resizeCanvas(){
      const ratio = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      if(rect.width === 0 || rect.height === 0){ return; }
      canvas.width = rect.width * ratio;
      canvas.height = rect.height * ratio;
      ctx.setTransform(1,0,0,1,0,0);
      ctx.scale(ratio, ratio);
    }

    function drawBars(vals){
      const rect = canvas.getBoundingClientRect();
      const w = rect.width;
      const h = rect.height;
      ctx.clearRect(0,0,w,h);
      if(!vals || vals.length === 0){ return; }
      ctx.globalAlpha = 0.25; ctx.strokeStyle = '#223049';
      for(let i=1;i<=4;i++){ const y = h - (h*i/5); ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }
      ctx.globalAlpha = 1;
      const m = vals.length;
      const pad = Math.max(16, w*0.06);
      const barW = Math.min(60, (w - pad*2) / Math.max(1,(m*1.5)));
      const gap = barW*0.5;
      const totalWidth = m*barW + (m-1)*gap;
      const startX = (w - totalWidth)/2;
      const maxV = Math.max(...vals, 0.001);
      vals.forEach((v,i)=>{
        const x = startX + i*(barW+gap);
        const y = h - (v/maxV)*h*0.9;
        ctx.fillStyle = '#6ea8ff';
        ctx.fillRect(x, y, barW, h-y);
        ctx.fillStyle = '#cfe0ff';
        ctx.textAlign = 'center';
        ctx.font = '13px system-ui, -apple-system, "Noto Sans Thai", sans-serif';
        ctx.fillText(`${lastKMin + i}`, x+barW/2, h-8);
        ctx.fillText(fmt(v,3), x+barW/2, Math.max(16, y-6));
      });
    }

    function refreshKOptions(N,K,n){
      const [kmin,kmax] = domainK(N,K,n);
      const prev = Number(kSel.value);
      kSel.innerHTML = '';
      if(kmin>kmax){
        const opt = document.createElement('option');
        opt.value = '0'; opt.textContent = '‚Äî';
        kSel.appendChild(opt);
        kSel.value = '0';
        kShow.textContent = '‚Äî';
        domPill.textContent = 'k ‚àà ‚Äî';
        return [kmin,kmax];
      }
      for(let k=kmin;k<=kmax;k++){
        const opt = document.createElement('option');
        opt.value = String(k);
        opt.textContent = k;
        if(k === prev){ opt.selected = true; }
        kSel.appendChild(opt);
      }
      if(!kSel.value){
        kSel.value = String(kmin);
      }
      kShow.textContent = kSel.value;
      domPill.textContent = `k ‚àà [${kmin}, ${kmax}]`;
      return [kmin,kmax];
    }

    function compute(){
      const notes = [];
      const N = readInt(NEl, 1, LIMIT_N, 'N', notes);
      const K = readInt(KEl, 0, Math.min(N, LIMIT_N), 'K', notes);
      const n = readInt(nEl, 0, Math.min(N, LIMIT_N), 'n', notes);
      const [kmin,kmax] = refreshKOptions(N,K,n);
      const k = clampInt(kSel.value, kmin, kmax);
      kSel.value = String(k);
      kShow.textContent = kSel.value;

      pmfRows.innerHTML = '';
      let total = 0; const vals = [];
      for(let x=kmin;x<=kmax;x++){
        const p = hyperPMF(N,K,n,x);
        vals.push(p);
        total += p;
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${x}</td><td>${fmt(p,6)}</td>`;
        pmfRows.appendChild(tr);
      }
      sumEl.textContent = fmt(total,6);

      const mean = n * (K / N);
      const variance = n * (K/N) * (1 - K/N) * ((N - n) / Math.max(1,(N - 1)));
      const sd = Math.sqrt(Math.max(variance,0));
      statsEl.textContent = `E[X]=${fmt(mean)}, Var(X)=${fmt(variance)}, SD=${fmt(sd)}`;

      pmfKEl.textContent = fmt(hyperPMF(N,K,n,k), 6);
      const base = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏î‡πâ‡∏ß‡∏¢ N=${N}, K=${K}, n=${n}`;
      statusEl.textContent = notes.length ? `${notes.join(' ‚Ä¢ ')} ‚Ä¢ ${base}` : base;
      lastVals = vals.slice();
      lastKMin = kmin;
      resizeCanvas();
      drawBars(lastVals);
    }

    btnCalc.addEventListener('click', compute);
    btnReset.addEventListener('click', ()=>{
      NEl.value=20; KEl.value=7; nEl.value=5;
      compute();
    });
    kSel.addEventListener('change', compute);

    window.addEventListener('resize', ()=>{
      resizeCanvas();
      drawBars(lastVals);
    });

    // ===== Combination Step-by-step =====
    const aEl = document.getElementById('a');
    const bEl = document.getElementById('b');
    const btnSteps = document.getElementById('btn-steps');
    const btnStepsReset = document.getElementById('btn-steps-reset');
    const stepsHead = document.getElementById('steps-head');
    const prodView = document.getElementById('prod-view');
    const stepsTable = document.querySelector('#steps-table tbody');
    const stepsFinal = document.getElementById('steps-final');
    const stepsStatus = document.getElementById('steps-status');

    function combSteps(n,r){
      n = Math.floor(n); r = Math.floor(r);
      if(r<0 || r>n) return {steps:[], final:{num:0,den:1,val:0}, display:{numTerms:[],denTerms:[]}, rUsed:0};
      const rr = Math.min(r, n-r);
      const numTerms = [], denTerms = [];
      for(let i=1;i<=rr;i++){
        numTerms.push(n - rr + i);
        denTerms.push(i);
      }
      let accNum = 1, accDen = 1;
      const steps = [];
      for(let i=1;i<=rr;i++){
        const rawN = numTerms[i-1];
        const rawD = denTerms[i-1];
        let simpN = rawN, simpD = rawD;
        const g1 = gcd(simpN, simpD);
        if(g1>1){ simpN/=g1; simpD/=g1; }
        accNum *= simpN;
        accDen *= simpD;
        const g2 = gcd(accNum, accDen);
        if(g2>1){ accNum/=g2; accDen/=g2; }
        steps.push({
          i, rawN, rawD, gcd_pair:g1, simpN, simpD,
          accNum, accDen, val: accNum/accDen
        });
      }
      return { steps, final:{num:accNum, den:accDen, val: accNum/accDen}, display:{numTerms, denTerms}, rUsed: rr };
    }

    function renderSteps(n,r, notes=[]){
      stepsHead.textContent = `C(${n}, ${r}) = ?`;
      const { steps, final, display, rUsed } = combSteps(n,r);
      const numStr = display.numTerms.length ? display.numTerms.join(' √ó ') : '1';
      const denStr = display.denTerms.length ? display.denTerms.join(' √ó ') : '1';
      prodView.innerHTML = `
        <span class="tag">r = min(${r}, ${n}-${r}) = ${rUsed}</span>
        <div class="mono" style="margin-top:.35rem">
          C(${n}, ${r}) = (${numStr}) / (${denStr})
        </div>
      `;
      stepsTable.innerHTML = '';
      steps.forEach(st=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${st.i}</td>
          <td>${st.rawN}</td>
          <td>${st.rawD}</td>
          <td>${st.gcd_pair}</td>
          <td>${st.simpN}</td>
          <td>${st.simpD}</td>
          <td>${st.accNum}</td>
          <td>${st.accDen}</td>
          <td>${fmt(st.val,6)}</td>
        `;
        stepsTable.appendChild(tr);
      });
      stepsFinal.textContent = `${fmt(final.val,6)}  (= ${final.num}/${final.den})`;
      const base = `‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏£‡∏ß‡∏° ${steps.length} ‡∏Ç‡∏±‡πâ‡∏ô)`;
      stepsStatus.textContent = notes.length ? `${notes.join(' ‚Ä¢ ')} ‚Ä¢ ${base}` : base;
    }

    btnSteps.addEventListener('click', ()=>{
      const notes = [];
      const a = readInt(aEl, 0, LIMIT_COMB, 'a', notes);
      const b = readInt(bEl, 0, Math.min(a, LIMIT_COMB), 'b', notes);
      renderSteps(a,b, notes);
    });
    btnStepsReset.addEventListener('click', ()=>{
      aEl.value = 20; bEl.value = 5;
      renderSteps(20,5, ['‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô']);
    });

    const btnCkk = document.getElementById('btn-step-Ckk');
    const btnCnk = document.getElementById('btn-step-Cnk');
    const btnCNn = document.getElementById('btn-step-CNn');

    function currentParams(){
      const N = clampInt(NEl.value, 1, LIMIT_N);
      const K = clampInt(KEl.value, 0, Math.min(N, LIMIT_N));
      const n = clampInt(nEl.value, 0, Math.min(N, LIMIT_N));
      const [kmin,kmax] = domainK(N,K,n);
      const k = clampInt(kSel.value, kmin, kmax);
      return {N,K,n,k,kmin,kmax};
    }

    btnCkk?.addEventListener('click', ()=>{
      const {K,k} = currentParams();
      aEl.value = K; bEl.value = k;
      renderSteps(K,k);
      stepsHead.scrollIntoView({behavior:'smooth', block:'start'});
    });
    btnCnk?.addEventListener('click', ()=>{
      const {N,K,n,k} = currentParams();
      const a = (N-K), b = (n-k);
      aEl.value = a; bEl.value = b;
      renderSteps(a,b);
      stepsHead.scrollIntoView({behavior:'smooth', block:'start'});
    });
    btnCNn?.addEventListener('click', ()=>{
      const {N,n} = currentParams();
      aEl.value = N; bEl.value = n;
      renderSteps(N,n);
      stepsHead.scrollIntoView({behavior:'smooth', block:'start'});
    });

    // ===== init =====
    function init(){
      resizeCanvas();
      refreshKOptions(20,7,5);
      compute();
      renderSteps(20,5);
    }
    init();
  </script>
</body>
</html>
