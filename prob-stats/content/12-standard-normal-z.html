<!DOCTYPE html>
<html class="theme-light" lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="บทที่ 12 อธิบายการแจกแจงปกติมาตรฐาน การคำนวณ Z-score การใช้ตาราง Z และแล็บโต้ตอบสำหรับหาพื้นที่ใต้โค้ง" />
  <title>บทที่ 12 • การแจกแจงปกติมาตรฐานและ Z-Score</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="print.css" media="print" />
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']],
        displayMath: [['\\[', '\\]']]
      },
      svg: { fontCache: 'global' },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea']
      }
    };
  </script>
  <script defer src="assets/js/reading-tools.js"></script>
  <style>
    :root {
      color-scheme: dark;
      --bg: #05060d;
      --surface: rgba(12, 16, 32, 0.9);
      --surface-alt: rgba(18, 24, 44, 0.85);
      --surface-soft: rgba(24, 30, 54, 0.7);
      --text: #f5f7ff;
      --muted: #9aa6c8;
      --accent: #8ab5ff;
      --accent-soft: rgba(138, 181, 255, 0.18);
      --border: rgba(130, 170, 255, 0.18);
      --ok: #65e7bd;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at 15% 5%, rgba(138, 181, 255, 0.22), transparent 58%),
                  radial-gradient(circle at 85% -10%, rgba(101, 231, 189, 0.18), transparent 60%),
                  var(--bg);
      color: var(--text);
      font: 16px/1.75 'Sarabun', 'Noto Sans Thai', system-ui, sans-serif;
    }

    header {
      background: linear-gradient(135deg, rgba(18, 28, 52, 0.96), rgba(138, 181, 255, 0.22));
      border-bottom: 1px solid var(--border);
      box-shadow: 0 18px 42px rgba(5, 9, 20, 0.55);
    }

    header .wrap,
    main,
    footer .wrap {
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.25rem 1.4rem 1.6rem;
    }

    h1,
    h2,
    h3 { line-height: 1.25; margin: 0.25rem 0 0.6rem; }
    h1 { font-size: clamp(1.9rem, 4vw, 2.5rem); }
    h2 { font-size: clamp(1.34rem, 3vw, 1.88rem); }
    h3 { font-size: clamp(1.12rem, 2.6vw, 1.4rem); }

    p,
    ul,
    ol { margin: 0.45rem 0 0.75rem; }

    .hero {
      display: grid;
      gap: 0.85rem;
      background: var(--surface);
      border-radius: 22px;
      border: 1px solid var(--border);
      padding: clamp(1.35rem, 2.4vw, 2.1rem);
      box-shadow: 0 18px 48px rgba(8, 12, 24, 0.45);
    }

    .hero p { color: var(--muted); margin: 0; }

    .eyebrow {
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--muted);
      font-size: 0.78rem;
    }

    .pill-row { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .pill {
      display: inline-flex;
      align-items: center;
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      background: rgba(20, 28, 54, 0.8);
      border: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.86rem;
    }

    main.wrap,
    .wrap main,
    main { display: grid; gap: 1.25rem; }

    .card {
      background: var(--surface);
      border-radius: 20px;
      border: 1px solid var(--border);
      padding: clamp(1.1rem, 2vw, 1.75rem);
      box-shadow: 0 18px 40px rgba(6, 10, 20, 0.42);
    }

    .callout {
      background: var(--surface-alt);
      border-radius: 18px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      padding: 0.85rem 1rem;
    }

    .muted { color: var(--muted); }

    .grid { display: grid; gap: 1rem; }
    @media (min-width: 900px) {
      .grid.two { grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .grid.three { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.6rem;
      font-size: 0.95rem;
    }

    th,
    td {
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      padding: 0.45rem 0.35rem;
      text-align: left;
    }

    th { color: var(--muted); font-weight: 600; }

    .lab {
      background: var(--surface-alt);
      border-radius: 18px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      padding: 1.1rem 1.25rem;
      display: grid;
      gap: 1rem;
    }

    .lab label {
      display: grid;
      gap: 0.3rem;
      font-weight: 600;
      font-size: 0.97rem;
    }

    .lab input,
    .lab select {
      background: rgba(6, 9, 18, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: var(--text);
      border-radius: 12px;
      padding: 0.55rem 0.7rem;
      font: inherit;
    }

    .lab input[type="range"] { width: 100%; }

    .lab button {
      justify-self: start;
      border: none;
      background: var(--accent);
      color: #081221;
      font-weight: 700;
      border-radius: 12px;
      padding: 0.55rem 1.2rem;
      cursor: pointer;
    }

    .svg-box {
      background: var(--surface-soft);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      padding: 0.75rem;
    }

    svg { width: 100%; height: auto; }

    footer {
      border-top: 1px solid var(--border);
      background: rgba(7, 11, 22, 0.88);
    }

    footer p { margin: 0; color: var(--muted); font-size: 0.92rem; }
  </style>
</head>
<body>
  <header>
    <div class="wrap hero">
      <span class="eyebrow">บทที่ 12</span>
      <h1>การแจกแจงปกติมาตรฐาน &amp; Z-Score</h1>
      <p>รวมโค้งปกติทุกแบบให้อยู่ในมาตรฐานเดียว (µ = 0, σ = 1) เพื่อใช้ตาราง Z และเปรียบเทียบข้อมูลจากบริบทต่าง ๆ ได้อย่างสะดวก</p>
      <div class="pill-row">
        <span class="pill">Standardisation</span>
        <span class="pill">Z-Table</span>
        <span class="pill">Shaded Area Explorer</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card grid two">
      <article>
        <h2>1. ทำไมต้องแปลงเป็นมาตรฐาน?</h2>
        <p>โค้งปกติสามารถมีรูปทรงได้ไม่จำกัด การสร้าง “ตารางพื้นที่ใต้โค้ง” ให้ครบทุกกรณีจึงเป็นไปไม่ได้ เราจึงแปลงทุกโค้งให้เป็นรูปเดียวที่มี \(\mu = 0\) และ \(\sigma = 1\) เรียกว่า <strong>Standard Normal Distribution</strong></p>
        <div class="callout">
          <p class="muted">เปรียบเทียบเหมือนการแปลงสกุลเงินทุกสกุลเป็นดอลลาร์ก่อนคำนวณ</p>
        </div>
        <ul>
          <li>หลังแปลงแล้วใช้ตาราง Z เพียงแผ่นเดียวได้กับทุกปัญหา</li>
          <li>ค่าที่แปลงแล้วเรียกว่า “คะแนนมาตรฐาน” หรือ Z-score</li>
        </ul>
      </article>
      <article>
        <h2>2. สูตรของ Z-Score</h2>
        <p class="callout">\[Z = \frac{X - \mu}{\sigma}\]</p>
        <ul>
          <li>\(Z &gt; 0\) → ค่าอยู่สูงกว่าค่าเฉลี่ย, \(Z &lt; 0\) → ต่ำกว่าค่าเฉลี่ย</li>
          <li>ขนาดของ |Z| บอกว่าอยู่ห่างจากค่าเฉลี่ยกี่เท่าของ \(\sigma\)</li>
          <li>ถ้า \(|Z| &gt; 3\) มักถือว่าเป็นค่าผิดปกติ (outlier)</li>
        </ul>
        <table>
          <thead><tr><th>ค่า Z</th><th>การตีความ</th></tr></thead>
          <tbody>
            <tr><td>-1.5</td><td>ต่ำกว่าค่าเฉลี่ย 1.5 เท่าของ σ</td></tr>
            <tr><td>0</td><td>เท่ากับค่าเฉลี่ยพอดี</td></tr>
            <tr><td>+2.2</td><td>สูงกว่าเฉลี่ย 2.2 σ (ค่อนข้างโดดเด่น)</td></tr>
          </tbody>
        </table>
      </article>
    </section>

    <section class="card">
      <h2>3. การใช้ตาราง Z</h2>
      <div class="grid two">
        <article class="callout">
          <h3>พื้นที่ด้านซ้าย</h3>
          <p>ตาราง Z ส่วนใหญ่ให้ค่าของ \(P(Z &lt; z)\) หรือพื้นที่จาก -∞ ถึง z</p>
        </article>
        <article class="callout">
          <h3>พื้นที่ด้านขวา &amp; ช่วง</h3>
          <ul>
            <li>\(P(Z &gt; z) = 1 - P(Z &lt; z)\)</li>
            <li>\(P(a &lt; Z &lt; b) = P(Z &lt; b) - P(Z &lt; a)\)</li>
          </ul>
        </article>
      </div>
      <p class="muted">เมื่อแปลงค่า X ด้วย Z-Score แล้ว จงใช้ความสัมพันธ์เหล่านี้ร่วมกับตาราง Z</p>
    </section>

    <section class="card" id="z-lab">
      <h2>Lab: คำนวณ Z-Score และหาพื้นที่</h2>
      <div class="lab">
        <div class="grid two">
          <label>ค่าดิบ \(X\)
            <input id="raw-x" type="number" value="85" step="0.1" />
          </label>
          <label>ค่าเฉลี่ย \(\mu\)
            <input id="raw-mu" type="number" value="70" step="0.1" />
          </label>
          <label>ส่วนเบี่ยงเบนมาตรฐาน \(\sigma\)
            <input id="raw-sigma" type="number" value="10" step="0.1" min="0.1" />
          </label>
          <label>รูปแบบพื้นที่
            <select id="prob-mode">
              <option value="left">P(Z &lt; z)</option>
              <option value="right">P(Z &gt; z)</option>
              <option value="between">P(a &lt; Z &lt; b)</option>
            </select>
          </label>
        </div>
        <div id="between-inputs" class="grid two" hidden>
          <label>Z ซ้าย (a)
            <input id="between-left" type="number" value="-1" step="0.1" min="-3.9" max="3.9" />
          </label>
          <label>Z ขวา (b)
            <input id="between-right" type="number" value="1" step="0.1" min="-3.9" max="3.9" />
          </label>
        </div>
        <label id="z-slider-label">ค่า Z (ปรับได้)
          <input id="z-slider" type="range" min="-3.5" max="3.5" step="0.1" value="1.5" />
        </label>
        <div class="svg-box">
          <svg id="z-svg" viewBox="0 0 460 260" role="img" aria-label="กราฟการแจกแจงปกติมาตรฐานพร้อมพื้นที่ที่เลือก"></svg>
        </div>
        <div class="callout" id="z-summary"></div>
      </div>
      <p class="muted">CDF ของ Z ใช้ฟังก์ชัน \(\operatorname{erf}\) เพื่อประมาณค่าอย่างแม่นยำ</p>
    </section>

    <section class="card">
      <h2>4. ตัวอย่าง: นักเรียนสอบได้ 85 คะแนน</h2>
      <ol>
        <li>\(Z = \dfrac{85 - 70}{10} = 1.5\)</li>
        <li>ต้องการหา \(P(X &gt; 85) = P(Z &gt; 1.5)\)</li>
        <li>\(P(Z &gt; 1.5) = 1 - P(Z &lt; 1.5) = 1 - 0.9332 = 0.0668\)</li>
      </ol>
      <p class="callout">มีโอกาส ~6.68% ที่นักเรียนจะได้คะแนนมากกว่า 85</p>
    </section>

    <section class="card">
      <h2>Self Check 🔍</h2>
      <ol>
        <li>การแปลงเป็น Z-Score ช่วยให้เราใช้ตารางเดียวกับข้อมูลทุกชุดได้อย่างไร?</li>
        <li>ถ้า Z = -2.3 หมายถึงอะไรเกี่ยวกับตำแหน่งของค่า X?</li>
        <li>เพราะอะไรการดู \(P(Z &gt; z)\) จึงต้องลบออกจาก 1?</li>
      </ol>
      <details>
        <summary>เฉลย</summary>
        <ul>
          <li>เพราะทุกโค้งถูกแปลงให้มีรูปทรงเดียวกัน (µ=0, σ=1) จึงใช้ตารางเดียวกันได้</li>
          <li>ค่า X อยู่ต่ำกว่าค่าเฉลี่ย 2.3 เท่าของส่วนเบี่ยงเบนมาตรฐาน</li>
          <li>ตาราง Z ให้พื้นที่ด้านซ้าย เมื่อเราต้องการด้านขวาจึงต้องใช้ 1 ลบพื้นที่ด้านซ้าย</li>
        </ul>
      </details>
    </section>
  </main>

  <footer>
    <div class="wrap">
      <p>© 2025 Prob &amp; Stats Interactive Notes — Lesson 12 Standard Normal &amp; Z-Score</p>
    </div>
  </footer>

  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
  <script>
    const rawX = document.getElementById('raw-x');
    const rawMu = document.getElementById('raw-mu');
    const rawSigma = document.getElementById('raw-sigma');
    const probMode = document.getElementById('prob-mode');
    const betweenInputs = document.getElementById('between-inputs');
    const betweenLeft = document.getElementById('between-left');
    const betweenRight = document.getElementById('between-right');
    const zSlider = document.getElementById('z-slider');
    const zSliderLabel = document.getElementById('z-slider-label');
    const zSvg = document.getElementById('z-svg');
    const zSummary = document.getElementById('z-summary');

    const SQRT_TWO_PI = Math.sqrt(2 * Math.PI);

    function erf(x) {
      const sign = Math.sign(x);
      const absX = Math.abs(x);
      const a1 = 0.254829592;
      const a2 = -0.284496736;
      const a3 = 1.421413741;
      const a4 = -1.453152027;
      const a5 = 1.061405429;
      const p = 0.3275911;
      const t = 1 / (1 + p * absX);
      const y = 1 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-absX * absX);
      return sign * y;
    }

    function normalPdf(z) {
      return Math.exp(-0.5 * z * z) / SQRT_TWO_PI;
    }

    function normalCdf(z) {
      return 0.5 * (1 + erf(z / Math.sqrt(2)));
    }

    function updateMode() {
      const mode = probMode.value;
      const showBetween = mode === 'between';
      betweenInputs.hidden = !showBetween;
      zSliderLabel.hidden = showBetween;
      drawZ();
    }

    function drawZ() {
      const mode = probMode.value;
      const mu = Number(rawMu.value);
      const sigma = Math.max(0.1, Number(rawSigma.value));
      const x = Number(rawX.value);
      const z = (x - mu) / sigma;

      let area = 0;
      let highlight = [];
      let description = '';

      if (mode === 'left') {
        const zValue = Number(zSlider.value);
        area = normalCdf(zValue);
        highlight = [-4, zValue];
        description = `P(Z < ${zValue.toFixed(2)})`;
      } else if (mode === 'right') {
        const zValue = Number(zSlider.value);
        area = 1 - normalCdf(zValue);
        highlight = [zValue, 4];
        description = `P(Z > ${zValue.toFixed(2)})`;
      } else {
        const a = Math.min(Number(betweenLeft.value), Number(betweenRight.value));
        const b = Math.max(Number(betweenLeft.value), Number(betweenRight.value));
        area = Math.max(0, normalCdf(b) - normalCdf(a));
        highlight = [a, b];
        description = `P(${a.toFixed(2)} < Z < ${b.toFixed(2)})`;
      }

      const points = [];
      let maxPdf = 0;
      const lower = -4;
      const upper = 4;
      const segments = 240;
      for (let i = 0; i <= segments; i++) {
        const zVal = lower + (i / segments) * (upper - lower);
        const pdf = normalPdf(zVal);
        if (pdf > maxPdf) maxPdf = pdf;
        points.push({ x: zVal, y: pdf });
      }

      const path = points
        .map((pt, idx) => {
          const sx = 20 + (pt.x - lower) / (upper - lower) * 420;
          const sy = 210 - (pt.y / maxPdf) * 170;
          return `${idx === 0 ? 'M' : 'L'}${sx.toFixed(2)} ${sy.toFixed(2)}`;
        })
        .join(' ');

      const highlightPts = points.filter(pt => pt.x >= highlight[0] && pt.x <= highlight[1]);
      const highlightPath = highlightPts
        .map((pt, idx) => {
          const sx = 20 + (pt.x - lower) / (upper - lower) * 420;
          const sy = 210 - (pt.y / maxPdf) * 170;
          if (idx === 0) {
            return `M${sx.toFixed(2)} 210 L${sx.toFixed(2)} ${sy.toFixed(2)}`;
          }
          return `L${sx.toFixed(2)} ${sy.toFixed(2)}`;
        })
        .join(' ');

      let highlightClose = '';
      if (highlightPts.length) {
        const end = highlightPts[highlightPts.length - 1];
        const endX = 20 + (end.x - lower) / (upper - lower) * 420;
        highlightClose = `L${endX.toFixed(2)} 210 Z`;
      }

      zSvg.innerHTML = `
        <defs>
          <linearGradient id="z-grad" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0%" stop-color="rgba(138,181,255,0.85)" />
            <stop offset="100%" stop-color="rgba(138,181,255,0.1)" />
          </linearGradient>
        </defs>
        <rect x="0" y="0" width="460" height="260" rx="22" fill="rgba(255,255,255,0.02)" stroke="rgba(255,255,255,0.05)" />
        <path d="${path}" fill="none" stroke="rgba(255,255,255,0.9)" stroke-width="2" />
        ${highlightPath ? `<path d="${highlightPath} ${highlightClose}" fill="url(#z-grad)" stroke="rgba(138,181,255,0.9)" stroke-width="1.6" />` : ''}
        <line x1="20" x2="440" y1="210" y2="210" stroke="rgba(255,255,255,0.08)" />
        <text x="230" y="240" text-anchor="middle" font-size="14" fill="#bfc9e5">ค่า Z</text>
      `;

      zSummary.innerHTML = `
        <p><strong>ค่า Z จากข้อมูล:</strong> ${(z).toFixed(3)}</p>
        <p><strong>${description}</strong> ≈ ${(area * 100).toFixed(2)}%</p>
        <p class="muted">ค่า Z บอกว่า X อยู่ห่างจาก µ ${Math.abs(z).toFixed(2)} เท่าของ σ (${z >= 0 ? 'สูงกว่า' : 'ต่ำกว่า'})</p>
      `;
    }

    [rawX, rawMu, rawSigma, zSlider, probMode, betweenLeft, betweenRight].forEach(el => {
      el.addEventListener('input', () => {
        if (el === probMode) updateMode(); else drawZ();
      });
    });

    updateMode();
  </script>
</body>
</html>
