<!DOCTYPE html>
<html class="theme-light" lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="ทดสอบสมมติฐานสัดส่วนประชากรเดียว ใช้สถิติ z พร้อมขั้นตอนและตัวอย่างคำนวณ" />
  <title>บทที่ 26 • ทดสอบสัดส่วนประชากรเดียว</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="print.css" media="print" />
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)'], ['$', '$']], displayMath: [['\\[', '\\]']] },
      svg: { fontCache: 'global' },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea'] }
    };
  </script>
  <script defer src="assets/js/reading-tools.js"></script>
  <style>
    :root {
      color-scheme: dark;
      --bg: #07060f;
      --surface: #141226;
      --surface-alt: #1b1932;
      --surface-soft: #221f40;
      --text: #f4f2ff;
      --muted: #9f9bc4;
      --accent: #ff8ad6;
      --accent-soft: rgba(255, 138, 214, 0.22);
      --border: #2a2748;
    }

    body { margin: 0; background: radial-gradient(circle at 10% -12%, rgba(255,138,214,0.22), transparent 58%), radial-gradient(circle at 90% 0%, rgba(122, 196, 255, 0.16), transparent 60%), var(--bg); color: var(--text); font: 16px/1.65 'Sarabun', 'Noto Sans Thai', system-ui, sans-serif; }
    header { background: linear-gradient(135deg, rgba(27, 25, 50, 0.95), rgba(255,138,214,0.24)); border-bottom: 1px solid var(--border); box-shadow: 0 22px 55px rgba(255,138,214,0.18); }
    header .wrap,
    main,
    footer .wrap { max-width: 1080px; margin: 0 auto; padding: 1.2rem 1.35rem 1.8rem; }

    h1, h2, h3 { line-height: 1.25; margin: 0.25rem 0 0.55rem; }
    h1 { font-size: clamp(1.9rem, 4vw, 2.45rem); }
    h2 { font-size: clamp(1.35rem, 3vw, 1.85rem); }
    h3 { font-size: clamp(1.12rem, 2.6vw, 1.35rem); }

    p, ul, ol { margin: 0.45rem 0 0.7rem; }
    a { color: var(--accent); }

    main.wrap { display: grid; gap: 1.2rem; padding-bottom: 4rem; }
    section.card, article.card { background: var(--surface); border-radius: 20px; border: 1px solid rgba(255,255,255,0.08); padding: clamp(1.1rem, 1.6vw, 1.85rem); box-shadow: 0 18px 44px rgba(0,0,0,0.35); }
    .hero { background: var(--surface-alt); display: grid; gap: 0.9rem; }
    .hero p { margin: 0; color: var(--muted); }
    .eyebrow { letter-spacing: 0.16em; text-transform: uppercase; font-size: 0.75rem; color: var(--muted); }

    .calc { display: grid; gap: 0.9rem; background: var(--surface-alt); border-radius: 16px; border: 1px solid rgba(255,255,255,0.06); padding: 1rem 1.1rem; }
    .calc label { display: grid; gap: 0.35rem; font-weight: 600; }
    .calc input, .calc select { background: rgba(14, 12, 26, 0.6); border: 1px solid var(--border); border-radius: 12px; color: var(--text); padding: 0.55rem 0.75rem; font: inherit; }
    .calc button { justify-self: start; border: none; border-radius: 12px; background: var(--accent); color: #310626; font-weight: 700; padding: 0.6rem 1.2rem; cursor: pointer; }

    .result-box { background: var(--surface-soft); border-radius: 16px; border: 1px solid rgba(255,255,255,0.08); padding: 0.9rem 1rem; }
    .result-box strong { font-size: 1.05rem; }
    .muted { color: var(--muted); font-size: 0.92rem; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <p class="eyebrow">บทที่ 26</p>
      <h1>ทดสอบสัดส่วนประชากรเดียว</h1>
      <p>กรณีคลาสสิก: ตรวจสอบว่า $p$ แตกต่างจาก $p_0$ หรือไม่ ด้วยสถิติ $z$</p>
    </div>
  </header>

  <main class="wrap">
    <section class="card hero">
      <h2>สูตรสำคัญ</h2>
      <ul>
        <li>ตัวประมาณ: $\hat p = x/n$</li>
        <li>Standard error ภายใต้ $H_0$: $SE = \sqrt{\dfrac{p_0(1-p_0)}{n}}$</li>
        <li>สถิติทดสอบ: $z = \dfrac{\hat p - p_0}{SE}$</li>
      </ul>
      <p>เงื่อนไข: $np_0$ และ $n(1-p_0)$ ควรมากกว่า 5 เพื่อใช้การประมาณปกติ</p>
    </section>

    <section class="card">
      <h2>เครื่องมือคำนวณ</h2>
      <form class="calc" id="htPropForm">
        <label>ทิศทางของ $H_a$
          <select name="tail">
            <option value="two" selected>$p \neq p_0$</option>
            <option value="right">$p &gt; p_0$</option>
            <option value="left">$p &lt; p_0$</option>
          </select>
        </label>
        <label>จำนวนความสำเร็จ ($x$)
          <input type="number" name="x" value="58" min="0" required />
        </label>
        <label>ขนาดตัวอย่าง ($n$)
          <input type="number" name="n" value="200" min="1" required />
        </label>
        <label>สัดส่วนภายใต้ $H_0$ ($p_0$)
          <input type="number" step="0.0001" name="p0" value="0.25" min="0" max="1" required />
        </label>
        <label>ระดับนัยสำคัญ ($\alpha$)
          <select name="alpha">
            <option value="0.10">0.10</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.01">0.01</option>
          </select>
        </label>
        <button type="submit">คำนวณผล</button>
      </form>
      <div class="result-box" id="htPropResult">
        <strong>ผลลัพธ์</strong>
        <p class="muted">ระบบจะบอกค่า $z$, p-value, และการตัดสินใจ</p>
      </div>
    </section>

    <section class="card">
      <h2>ข้อควรระวัง</h2>
      <ul>
        <li>ถ้าตัวอย่างน้อย ให้ใช้ Exact binomial test</li>
        <li>อย่าลืมใช้ $p_0$ ในการคำนวณ $SE$ ตามนิยาม</li>
        <li>รายงานความเชื่อมั่น เช่น “p-value = 0.018 → ปฏิเสธ $H_0$ ที่ระดับ 5%”</li>
      </ul>
    </section>
  </main>

  <script>
    function erf(x) {
      const sign = Math.sign(x);
      const ax = Math.abs(x);
      const t = 1 / (1 + 0.5 * ax);
      const tau = t * Math.exp(-ax * ax - 1.26551223 +
        t * (1.00002368 +
        t * (0.37409196 +
        t * (0.09678418 +
        t * (-0.18628806 +
        t * (0.27886807 +
        t * (-1.13520398 +
        t * (1.48851587 +
        t * (-0.82215223 + t * 0.17087277)))))))));
      return 1 - tau * sign;
    }

    function normCDF(x) {
      return 0.5 * (1 + erf(x / Math.SQRT2));
    }

    const zCriticalMap = {
      '0.10_two': 1.6449,
      '0.05_two': 1.96,
      '0.01_two': 2.5758,
      '0.10_right': 1.2816,
      '0.05_right': 1.6449,
      '0.01_right': 2.3263,
      '0.10_left': -1.2816,
      '0.05_left': -1.6449,
      '0.01_left': -2.3263
    };

    const form = document.getElementById('htPropForm');
    const resultBox = document.getElementById('htPropResult');

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      const tail = form.tail.value;
      const x = Number(form.x.value);
      const n = Number(form.n.value);
      const p0 = Number(form.p0.value);
      const alpha = form.alpha.value;

      if (n <= 0 || x < 0 || x > n || p0 <= 0 || p0 >= 1) {
        resultBox.innerHTML = '<p>ตรวจสอบข้อมูล: 0 &lt; p_0 &lt; 1 และ 0 ≤ x ≤ n</p>';
        return;
      }

      const phat = x / n;
      const se = Math.sqrt(p0 * (1 - p0) / n);
      const z = (phat - p0) / se;
      let pValue;
      if (tail === 'two') {
        pValue = 2 * (1 - normCDF(Math.abs(z)));
      } else if (tail === 'right') {
        pValue = 1 - normCDF(z);
      } else {
        pValue = normCDF(z);
      }

      const crit = zCriticalMap[`${alpha}_${tail}`];
      const reject = pValue <= Number(alpha);
      const decision = reject ? 'ปฏิเสธ $H_0$' : 'ยังไม่ปฏิเสธ $H_0$';

      resultBox.innerHTML = `
        <strong>${decision}</strong>
        <p>$\hat p = ${phat.toFixed(4)}$, $z = ${z.toFixed(3)}$, Critical = ${crit.toFixed(3)}</p>
        <p>$p\text{-value} = ${pValue.toFixed(4)}$</p>
        <p class="muted">เงื่อนไขการประมาณ: $np_0 = ${(n * p0).toFixed(1)}$, $n(1-p_0) = ${(n * (1 - p0)).toFixed(1)}$</p>
      `;
      if (window.MathJax?.typeset) {
        MathJax.typeset([resultBox]);
      }
    });
  </script>
</body>
</html>
