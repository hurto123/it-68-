<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡∏ö‡∏ó‡∏ó‡∏µ‡πà 21: ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Sample Size)</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    :root { color-scheme: light dark; }
    body {
      margin: 0;
      font-family: "IBM Plex Sans Thai", "Prompt", "Sarabun", system-ui, sans-serif;
      background: radial-gradient(circle at 16% 15%, rgba(3, 155, 229, 0.24), transparent 65%),
                  radial-gradient(circle at 82% 24%, rgba(30, 136, 229, 0.22), transparent 60%),
                  linear-gradient(180deg, #eef6ff 0%, #ffffff 45%, #e6f2ff 100%);
      min-height: 100vh;
      color: #06335b;
    }
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: clamp(2rem, 4vw, 3.6rem) clamp(1.4rem, 3vw, 3rem) 4rem;
      display: grid;
      gap: 2.4rem;
    }
    header.hero {
      background: linear-gradient(135deg, #0288d1, #01579b);
      color: #fff;
      padding: clamp(2.6rem, 4vw, 3.8rem);
      border-radius: 34px;
      box-shadow: 0 32px 64px rgba(1, 87, 155, 0.28);
      position: relative;
      overflow: hidden;
    }
    header.hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 18% 24%, rgba(255,255,255,0.32), transparent 55%),
                  radial-gradient(circle at 82% 70%, rgba(255,255,255,0.24), transparent 60%);
    }
    header.hero h1 { font-size: clamp(2.3rem, 3.2vw, 3.45rem); margin: 0 0 0.9rem; }
    header.hero p { font-size: 1.05rem; line-height: 1.8; max-width: 780px; }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(255,255,255,0.18);
      border: 1px solid rgba(255,255,255,0.25);
      padding: 0.45rem 1.2rem;
      border-radius: 999px;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 1.4rem;
    }
    section.card {
      background: rgba(255,255,255,0.92);
      border-radius: 28px;
      padding: clamp(1.9rem, 4vw, 2.6rem);
      box-shadow: 0 26px 55px rgba(1, 87, 155, 0.16);
      backdrop-filter: blur(6px);
      display: grid;
      gap: 1.25rem;
    }
    section.card h2 {
      margin: 0;
      font-size: 1.9rem;
      color: #01579b;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    article.panel {
      background: rgba(2, 136, 209, 0.08);
      border: 1px solid rgba(1, 87, 155, 0.18);
      border-radius: 22px;
      padding: 1.4rem 1.6rem;
      display: grid;
      gap: 0.7rem;
    }
    .highlight {
      border-left: 5px solid #0277bd;
      padding: 1rem 1.4rem;
      background: rgba(2, 119, 189, 0.1);
      border-radius: 18px;
    }
    ul, p, li { line-height: 1.75; }
    .grid-two { display: grid; gap: 1.4rem; }
    @media (min-width: 960px) { .grid-two { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    .calculator { display: grid; gap: 1rem; }
    label span { font-weight: 600; color: #0a4474; }
    input[type="number"], input[type="range"], select {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 16px;
      border: 1px solid rgba(1, 87, 155, 0.2);
      font-size: 1rem;
      background: rgba(255,255,255,0.96);
    }
    button {
      background: linear-gradient(135deg, #0288d1, #1565c0);
      color: #fff;
      border: none;
      border-radius: 16px;
      padding: 0.9rem 1.3rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 18px 34px rgba(2, 136, 209, 0.25); }
    .result-card {
      background: rgba(234, 246, 255, 0.96);
      border: 1px solid rgba(1, 87, 155, 0.18);
      border-radius: 20px;
      padding: 1.1rem 1.4rem;
      display: grid;
      gap: 0.4rem;
    }
    .note { font-size: 0.95rem; color: #0b4370; }
  </style>
</head>
<body>
  <main>
    <header class="hero">
      <div class="badge">üë®‚Äçüè´ ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 21 ¬∑ Planning Sample Size</div>
      <h1>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</h1>
      <p>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤! ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ß‡πà‡∏≤ ‚Äú‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏µ‡πà‡∏Ñ‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏û‡∏≠?‚Äù ‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏•‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏Å‡πá‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á ‡πÉ‡∏ô‡∏ö‡∏ó‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏•‡∏¥‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤.</p>
    </header>

    <section class="card">
      <h2>1. ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
      <p>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ n ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏ï‡∏≠‡∏ö‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏∑‡∏≠ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô (E), ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô (‡∏Å‡∏≥‡∏´‡∏ô‡∏î \(Z_{\alpha/2}\)) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ (œÉ ‡∏´‡∏£‡∏∑‡∏≠ p).</p>
    </section>

    <section class="card">
      <h2>2. &amp; 3. ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ</h2>
      <div class="grid-two">
        <article class="panel">
          <h3>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Œº)</h3>
          <p class="math">\[ n = \left( \frac{Z_{\alpha/2} \cdot \sigma}{E} \right)^2 \]</p>
          <ul>
            <li>‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ œÉ ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠ pilot study)</li>
            <li>‡∏¢‡∏¥‡πà‡∏á E ‡πÄ‡∏•‡πá‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏™‡∏π‡∏á ‚áí n ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô</li>
          </ul>
        </article>
        <article class="panel">
          <h3>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (p)</h3>
          <p class="math">\[ n = p(1-p) \left( \frac{Z_{\alpha/2}}{E} \right)^2 \]</p>
          <ul>
            <li>‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ p ‡πÄ‡∏•‡∏¢ ‚áí ‡πÉ‡∏ä‡πâ p = 0.5 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ n ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)</li>
            <li>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ ‚Äú‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏Ñ‡∏ô‚Äù ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</li>
          </ul>
        </article>
      </div>
      <div class="highlight">
        <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á ‚áí ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô | ‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‚áí ‡∏Ñ‡πà‡∏≤ Z ‡∏™‡∏π‡∏á ‚áí n ‡πÄ‡∏û‡∏¥‡πà‡∏° | ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏°‡∏≤‡∏Å (œÉ ‡∏´‡∏£‡∏∑‡∏≠ p(1-p) ‡∏™‡∏π‡∏á) ‚áí n ‡πÄ‡∏û‡∏¥‡πà‡∏°.</p>
      </div>
    </section>

    <section class="card">
      <h2>4. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h2>
      <div class="grid-two">
        <article class="panel">
          <h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</h3>
          <p>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ö‡∏±‡∏ì‡∏ë‡∏¥‡∏ï‡πÉ‡∏´‡∏°‡πà 95% CI ‡πÅ‡∏•‡∏∞ E ‚â§ 500 ‡∏ö‡∏≤‡∏ó ‡πÇ‡∏î‡∏¢‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ œÉ ‚âà 4,000 ‡∏ö‡∏≤‡∏ó</p>
          <ul>
            <li>Z = 1.96</li>
            <li>\(n = (1.96 ¬∑ 4000 / 500)^2 = 245.86\)</li>
            <li>‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‚áí n = 246 ‡∏Ñ‡∏ô</li>
          </ul>
        </article>
        <article class="panel">
          <h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 2: ‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô</h3>
          <p>‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏û‡∏•‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡πÉ‡∏´‡∏°‡πà 99% CI ‡πÅ‡∏•‡∏∞ E ‚â§ 0.04 ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• p ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô</p>
          <ul>
            <li>Z = 2.576, p = 0.5</li>
            <li>\(n = 0.5(1-0.5) (2.576/0.04)^2 = 1036.84\)</li>
            <li>‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‚áí n = 1,037 ‡∏Ñ‡∏ô</li>
          </ul>
        </article>
      </div>
    </section>

    <section class="card">
      <h2>5. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</h2>
      <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π n ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.</p>
      <div class="calculator">
        <label><span>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</span>
          <select id="type">
            <option value="mean">‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Œº)</option>
            <option value="proportion">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (p)</option>
          </select>
        </label>
        <label><span>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô (%)</span>
          <input type="range" id="confidence" min="80" max="99" value="95" />
        </label>
        <label><span>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô (E)</span>
          <input type="number" id="margin" value="500" step="0.001" min="0.0001" />
        </label>
        <label id="sigmaLabel"><span>‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ œÉ</span>
          <input type="number" id="sigma" value="4000" step="0.001" min="0" />
        </label>
        <label id="pLabel" style="display:none"><span>‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ p</span>
          <input type="number" id="p" value="0.5" step="0.01" min="0" max="1" />
        </label>
        <div class="note">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô: <strong id="confValue">95%</strong> | Z = <strong id="zValue">1.960</strong></div>
        <button id="calcBtn">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì n</button>
      </div>
      <div class="result-card" id="result" style="display:none"></div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/jstat@1.9.5/dist/jstat.min.js"></script>
  <script>
    const typeEl = document.getElementById('type');
    const confEl = document.getElementById('confidence');
    const marginEl = document.getElementById('margin');
    const sigmaEl = document.getElementById('sigma');
    const sigmaLabel = document.getElementById('sigmaLabel');
    const pEl = document.getElementById('p');
    const pLabel = document.getElementById('pLabel');
    const confValueEl = document.getElementById('confValue');
    const zValueEl = document.getElementById('zValue');
    const resultEl = document.getElementById('result');
    const calcBtn = document.getElementById('calcBtn');

    function updateVisibility() {
      if (typeEl.value === 'mean') {
        sigmaLabel.style.display = '';
        pLabel.style.display = 'none';
      } else {
        sigmaLabel.style.display = 'none';
        pLabel.style.display = '';
      }
    }

    function computeN() {
      const confidence = Number(confEl.value) / 100;
      const alpha = 1 - confidence;
      const z = jStat.normal.inv(1 - alpha / 2, 0, 1);
      confValueEl.textContent = `${(confidence * 100).toFixed(0)}%`;
      zValueEl.textContent = z.toFixed(3);

      const margin = Math.max(Number(marginEl.value), 0.0001);
      let n;
      if (typeEl.value === 'mean') {
        const sigma = Math.max(Number(sigmaEl.value), 0);
        n = ((z * sigma) / margin) ** 2;
      } else {
        const p = Math.min(Math.max(Number(pEl.value), 0), 1);
        pEl.value = p;
        n = p * (1 - p) * ((z / margin) ** 2);
      }

      const nCeil = Math.ceil(n);
      resultEl.style.display = 'grid';
      resultEl.innerHTML = `
        <strong>‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ ${nCeil.toLocaleString('th-TH')} ‡∏´‡∏ô‡πà‡∏ß‡∏¢</strong>
        <span>‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏õ‡∏±‡∏î) = ${n.toFixed(3)}</span>
        <span class="note">‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á</span>
      `;
    }

    typeEl.addEventListener('change', () => { updateVisibility(); computeN(); });
    [confEl, marginEl, sigmaEl, pEl].forEach(el => el.addEventListener('input', computeN));
    calcBtn.addEventListener('click', computeN);

    updateVisibility();
    computeN();
  </script>
</body>
</html>
