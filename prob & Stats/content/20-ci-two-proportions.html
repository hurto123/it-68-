<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>‡∏ö‡∏ó‡∏ó‡∏µ‡πà 20: ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ (p‚ÇÅ ‚àí p‚ÇÇ)</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    :root { color-scheme: light dark; }
    body {
      margin: 0;
      font-family: "IBM Plex Sans Thai", "Prompt", "Sarabun", system-ui, sans-serif;
      background: radial-gradient(circle at 16% 18%, rgba(255, 152, 0, 0.25), transparent 65%),
                  radial-gradient(circle at 82% 24%, rgba(255, 87, 34, 0.22), transparent 60%),
                  linear-gradient(180deg, #fff6eb 0%, #ffffff 45%, #fff0e0 100%);
      min-height: 100vh;
      color: #351803;
    }
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: clamp(2rem, 4vw, 3.6rem) clamp(1.4rem, 3vw, 3rem) 4rem;
      display: grid;
      gap: 2.4rem;
    }
    header.hero {
      background: linear-gradient(135deg, #f57c00, #e65100);
      color: #fff;
      padding: clamp(2.6rem, 4vw, 3.8rem);
      border-radius: 34px;
      box-shadow: 0 32px 64px rgba(230, 81, 0, 0.28);
      position: relative;
      overflow: hidden;
    }
    header.hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 18% 24%, rgba(255,255,255,0.32), transparent 55%),
                  radial-gradient(circle at 82% 68%, rgba(255,255,255,0.24), transparent 60%);
    }
    header.hero h1 { font-size: clamp(2.3rem, 3.2vw, 3.4rem); margin: 0 0 0.9rem; }
    header.hero p { font-size: 1.05rem; line-height: 1.8; max-width: 780px; }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(255,255,255,0.18);
      border: 1px solid rgba(255,255,255,0.28);
      padding: 0.45rem 1.2rem;
      border-radius: 999px;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 1.4rem;
    }
    section.card {
      background: rgba(255,255,255,0.92);
      border-radius: 28px;
      padding: clamp(1.9rem, 4vw, 2.6rem);
      box-shadow: 0 26px 55px rgba(230, 81, 0, 0.16);
      backdrop-filter: blur(6px);
      display: grid;
      gap: 1.25rem;
    }
    section.card h2 {
      margin: 0;
      font-size: 1.9rem;
      color: #e65100;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    article.panel {
      background: rgba(255, 152, 0, 0.08);
      border: 1px solid rgba(230, 81, 0, 0.16);
      border-radius: 22px;
      padding: 1.4rem 1.6rem;
      display: grid;
      gap: 0.7rem;
    }
    .grid-two { display: grid; gap: 1.4rem; }
    @media (min-width: 960px) { .grid-two { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    .highlight {
      border-left: 5px solid #fb8c00;
      padding: 1rem 1.4rem;
      background: rgba(251, 140, 0, 0.1);
      border-radius: 18px;
    }
    .note { font-size: 0.95rem; color: #6d3000; }
    ul, p, li { line-height: 1.75; }
    .calculator { display: grid; gap: 1rem; }
    label span { font-weight: 600; color: #6d3200; }
    input[type="number"], input[type="range"] {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 16px;
      border: 1px solid rgba(230, 81, 0, 0.22);
      font-size: 1rem;
      background: rgba(255,255,255,0.96);
    }
    button {
      background: linear-gradient(135deg, #f57c00, #d84315);
      color: #fff;
      border: none;
      border-radius: 16px;
      padding: 0.9rem 1.3rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover { transform: translateY(-2px); box-shadow: 0 18px 34px rgba(240, 98, 0, 0.25); }
    .result-card {
      background: rgba(255, 244, 229, 0.96);
      border: 1px solid rgba(230, 81, 0, 0.18);
      border-radius: 20px;
      padding: 1.1rem 1.4rem;
      display: grid;
      gap: 0.4rem;
    }
    canvas { background: rgba(255, 240, 222, 0.92); border-radius: 20px; padding: 1rem; }
  </style>
</head>
<body>
  <main>
    <header class="hero">
      <div class="badge">üë®‚Äçüè´ ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 20 ¬∑ Comparing Proportions</div>
      <h1>‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£ (p‚ÇÅ ‚àí p‚ÇÇ)</h1>
      <p>‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤! ‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏±‡∏ô‡∏ö‡πâ‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Å‡∏±‡∏ö‡∏¢‡∏≤‡∏´‡∏•‡∏≠‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ä‡∏≠‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ A ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö B ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£‡∏™‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô.</p>
    </header>

    <section class="card">
      <h2>1. ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</h2>
      <p>‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö‡∏à‡∏∏‡∏î‡∏Ñ‡∏∑‡∏≠ \(\hat{p}_1 - \hat{p}_2\) ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏° ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏≠ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ Z-distribution ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö \(p_1 - p_2\).</p>
    </section>

    <section class="card">
      <h2>2. &amp; 3. ‡∏™‡∏π‡∏ï‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
      <div class="grid-two">
        <article class="panel">
          <p>‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á n‚ÇÅ ‡πÅ‡∏•‡∏∞ n‚ÇÇ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à x‚ÇÅ ‡πÅ‡∏•‡∏∞ x‚ÇÇ:</p>
          <ul>
            <li>\(\hat{p}_1 = x_1 / n_1\)</li>
            <li>\(\hat{p}_2 = x_2 / n_2\)</li>
            <li>Standard Error = \(\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2(1-\hat{p}_2)}{n_2}}\)</li>
          </ul>
        </article>
        <article class="panel">
          <h3>‡∏™‡∏π‡∏ï‡∏£‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô</h3>
          <p class="math">\[ CI = (\hat{p}_1 - \hat{p}_2) \pm Z_{\alpha/2} \sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2(1-\hat{p}_2)}{n_2}} \]</p>
          <p>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: ‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤ ¬± ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô</p>
        </article>
      </div>
    </section>

    <section class="card">
      <h2>4. ‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏•‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå</h2>
      <ul>
        <li>‡∏ä‡πà‡∏ß‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡πà‡∏≠‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏ö‡∏ß‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚áí \(p_1 > p_2\) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</li>
        <li>‡∏ä‡πà‡∏ß‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡πà‡∏≠‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚áí \(p_1 < p_2\) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</li>
        <li>‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏£‡πà‡∏≠‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå ‚áí ‡∏¢‡∏±‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô</li>
      </ul>
    </section>

    <section class="card">
      <h2>5. ‡∏¢‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏¢‡∏≤</h2>
      <article class="panel">
        <ul>
          <li>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏≤‡∏´‡∏•‡∏≠‡∏Å: n‚ÇÅ = 500, x‚ÇÅ = 45 ‚áí \(\hat{p}_1 = 0.09\)</li>
          <li>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏≤‡∏à‡∏£‡∏¥‡∏á: n‚ÇÇ = 500, x‚ÇÇ = 25 ‚áí \(\hat{p}_2 = 0.05\)</li>
          <li>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô 95% ‚áí Z = 1.96</li>
        </ul>
        <div class="steps">
          <p>‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á = 0.09 ‚àí 0.05 = 0.04</p>
          <p>SE = \(\sqrt{0.09(0.91)/500 + 0.05(0.95)/500} = 0.01609\)</p>
          <p>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠ = 1.96 √ó 0.01609 = 0.0315</p>
          <p>CI = 0.04 ¬± 0.0315 ‚áí (0.0085, 0.0715)</p>
        </div>
        <p class="note">‡∏ä‡πà‡∏ß‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡πà‡∏≠‡∏°‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ß‡∏Å ‚áí ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏•‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏Ç‡πâ‡∏´‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á.</p>
      </article>
    </section>

    <section class="card">
      <h2>6. ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö</h2>
      <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.</p>
      <div class="calculator">
        <label><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏•‡∏∏‡πà‡∏° 1 (x‚ÇÅ)</span>
          <input type="number" id="x1" value="45" min="0" />
        </label>
        <label><span>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° 1 (n‚ÇÅ)</span>
          <input type="number" id="n1" value="500" min="1" />
        </label>
        <label><span>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏•‡∏∏‡πà‡∏° 2 (x‚ÇÇ)</span>
          <input type="number" id="x2" value="25" min="0" />
        </label>
        <label><span>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° 2 (n‚ÇÇ)</span>
          <input type="number" id="n2" value="500" min="1" />
        </label>
        <label><span>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô (%)</span>
          <input type="range" id="confidence" min="80" max="99" value="95" />
        </label>
        <div class="note">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô: <strong id="confValue">95%</strong></div>
        <button id="calcBtn">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ä‡πà‡∏ß‡∏á</button>
      </div>
      <div class="result-card" id="result" style="display:none"></div>
      <canvas id="ciChart" height="260"></canvas>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@1.9.5/dist/jstat.min.js"></script>
  <script>
    const x1El = document.getElementById('x1');
    const n1El = document.getElementById('n1');
    const x2El = document.getElementById('x2');
    const n2El = document.getElementById('n2');
    const confEl = document.getElementById('confidence');
    const confValueEl = document.getElementById('confValue');
    const resultEl = document.getElementById('result');
    const calcBtn = document.getElementById('calcBtn');
    const ctx = document.getElementById('ciChart').getContext('2d');
    let chart;

    function calcCI() {
      const x1 = Math.max(Number(x1El.value), 0);
      const x2 = Math.max(Number(x2El.value), 0);
      const n1 = Math.max(Number.parseInt(n1El.value, 10), 1);
      const n2 = Math.max(Number.parseInt(n2El.value, 10), 1);
      n1El.value = n1;
      n2El.value = n2;
      x1El.max = n1;
      x2El.max = n2;

      const p1 = Math.min(x1 / n1, 1);
      const p2 = Math.min(x2 / n2, 1);
      const diff = p1 - p2;
      const confidence = Number(confEl.value) / 100;
      confValueEl.textContent = `${(confidence * 100).toFixed(0)}%`;
      const alpha = 1 - confidence;
      const critical = jStat.normal.inv(1 - alpha / 2, 0, 1);
      const se = Math.sqrt(Math.max(p1 * (1 - p1) / n1 + p2 * (1 - p2) / n2, 0));
      const margin = critical * se;
      const lower = diff - margin;
      const upper = diff + margin;

      resultEl.style.display = 'grid';
      resultEl.innerHTML = `
        <strong>‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô = ${(diff * 100).toFixed(2)}%</strong>
        <span>SE = ${(se * 100).toFixed(2)}% ¬∑ Z = ${critical.toFixed(3)}</span>
        <span>‡∏ä‡πà‡∏ß‡∏á ${(confidence * 100).toFixed(1)}% = [${(lower * 100).toFixed(2)}%, ${(upper * 100).toFixed(2)}%]</span>
        <span class="note">‡πÄ‡∏•‡∏Ç‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</span>
      `;

      const points = 160;
      const xs = [];
      const base = [];
      const fill = [];
      const seSafe = se === 0 ? 1e-9 : se;
      const range = Math.max(4 * seSafe, Math.abs(margin) * 1.3 + seSafe);
      for (let i = 0; i <= points; i += 1) {
        const x = diff - range + (2 * range * i) / points;
        xs.push((x * 100).toFixed(2));
        const standardized = (x - diff) / seSafe;
        const density = jStat.normal.pdf(standardized, 0, 1) / seSafe;
        base.push(density);
        fill.push(x >= lower && x <= upper ? density : null);
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: xs,
          datasets: [
            {
              label: '‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á',
              data: base,
              borderColor: 'rgba(230,81,0,0.45)',
              backgroundColor: 'rgba(230,81,0,0.08)',
              borderWidth: 2.6,
              pointRadius: 0,
              tension: 0.25
            },
            {
              label: '‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô',
              data: fill,
              borderColor: 'rgba(255,143,0,0.9)',
              backgroundColor: 'rgba(255,143,0,0.28)',
              borderWidth: 3,
              pointRadius: 0,
              tension: 0.25,
              fill: true
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { labels: { color: '#6d3000' } },
            tooltip: {
              callbacks: {
                label: (ctx) => `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô ‚âà ${Number(ctx.raw).toFixed(4)}`
              }
            }
          },
          scales: {
            x: {
              ticks: { color: '#6d3000', maxRotation: 0 },
              title: { display: true, text: '‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ (%)', color: '#6d3000' }
            },
            y: {
              ticks: { color: '#6d3000' },
              title: { display: true, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô', color: '#6d3000' }
            }
          }
        }
      });
    }

    [x1El, x2El, n1El, n2El].forEach(el => el.addEventListener('input', calcCI));
    confEl.addEventListener('input', calcCI);
    calcBtn.addEventListener('click', calcCI);
    calcCI();
  </script>
</body>
</html>
