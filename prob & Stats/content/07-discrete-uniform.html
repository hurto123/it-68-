<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <title>บทที่ 7: การแจกแจงเอกรูปไม่ต่อเนื่อง</title>
  <link rel="stylesheet" href="../style.css" />
  <style>
    :root { color-scheme: light dark; }
    body.page {
      min-height: 100vh;
      background: linear-gradient(140deg, rgba(224,247,250,0.9), rgba(232,245,253,0.92));
      font-family: "IBM Plex Sans Thai", "Prompt", "Sarabun", system-ui, sans-serif;
    }
    main.container {
      max-width: 1080px;
      margin: 0 auto;
      padding: clamp(2rem, 5vw, 3.6rem);
    }
    header.hero {
      background: linear-gradient(135deg, #00838f, #00acc1);
      color: #fff;
      padding: clamp(2.7rem, 6vw, 3.8rem);
      border-radius: 32px;
      position: relative;
      overflow: hidden;
      margin-bottom: 2.4rem;
      box-shadow: 0 28px 48px rgba(0,131,143,0.28);
    }
    header.hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 82% 20%, rgba(255,255,255,0.35), transparent 60%),
                  radial-gradient(circle at 18% 70%, rgba(255,255,255,0.25), transparent 70%);
    }
    header.hero h1 {
      font-size: clamp(2.4rem, 3vw + 1.5rem, 3.6rem);
      margin-bottom: 0.75rem;
    }
    header.hero p {
      font-size: 1.12rem;
      max-width: 720px;
      line-height: 1.7;
    }
    section.card {
      background: rgba(255,255,255,0.95);
      border-radius: 26px;
      padding: clamp(1.7rem, 4vw, 2.7rem);
      margin-bottom: 2.1rem;
      box-shadow: 0 20px 34px rgba(0,121,128,0.18);
    }
    h2 {
      display: flex;
      align-items: center;
      gap: 0.7rem;
      font-size: 1.95rem;
      color: #006064;
    }
    .badge {
      background: rgba(178,235,242,0.8);
      border-radius: 999px;
      padding: 0.18rem 0.9rem;
      color: #004d40;
      font-weight: 600;
      font-size: 0.92rem;
    }
    .grid {
      display: grid;
      gap: 1.4rem;
    }
    @media (min-width: 900px) {
      .grid.two { grid-template-columns: repeat(2, minmax(0,1fr)); }
      .grid.three { grid-template-columns: repeat(3, minmax(0,1fr)); }
    }
    article.definition {
      border-radius: 20px;
      background: linear-gradient(160deg, rgba(178,235,242,0.55), rgba(224,247,250,0.65));
      border: 1px solid rgba(0,121,107,0.2);
      padding: 1.35rem 1.5rem;
      display: grid;
      gap: 0.7rem;
    }
    article.definition strong { color: #006064; font-size: 1.08rem; }
    .highlight {
      border-left: 6px solid #0097a7;
      background: rgba(0,151,167,0.12);
      border-radius: 18px;
      padding: 1rem 1.2rem;
    }
    .code-box {
      background: #00363a;
      color: #b2ebf2;
      padding: 1rem 1.2rem;
      border-radius: 14px;
      font-family: "Fira Code", "Consolas", monospace;
      font-size: 0.95rem;
      overflow-x: auto;
    }
    .note { color: #006064; font-size: 0.95rem; }
    .calculator { display: grid; gap: 1rem; margin-top: 1.1rem; }
    .calculator label { font-weight: 600; color: #004d40; }
    .calculator input,
    .calculator select {
      border-radius: 14px;
      border: 1px solid rgba(0,121,107,0.35);
      padding: 0.65rem 0.85rem;
      font-size: 1rem;
      background: rgba(240,255,255,0.9);
    }
    .calculator button {
      border: none;
      border-radius: 999px;
      padding: 0.75rem 1.8rem;
      background: linear-gradient(135deg, #00838f, #00acc1);
      color: #e0f7fa;
      font-weight: 600;
      cursor: pointer;
      justify-self: flex-start;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .calculator button:hover { transform: translateY(-1px); box-shadow: 0 12px 24px rgba(0,131,143,0.32); }
    .result-card {
      border-radius: 18px;
      background: rgba(0,150,136,0.12);
      padding: 1rem 1.3rem;
      color: #004d40;
      font-weight: 600;
      display: none;
      gap: 0.35rem;
    }
    .pill-list { display: flex; flex-wrap: wrap; gap: 0.6rem; }
    .pill { padding: 0.35rem 0.85rem; border-radius: 999px; background: rgba(128,222,234,0.55); color: #004d40; font-weight: 600; font-size: 0.88rem; }
    .table-wrapper { overflow-x: auto; border-radius: 16px; border: 1px solid rgba(0,121,107,0.18); margin-top: 1.3rem; display:none; }
    table.styled { width: 100%; border-collapse: collapse; min-width: 480px; }
    table.styled th, table.styled td { padding: 0.85rem 1.1rem; text-align: center; }
    table.styled thead { background: rgba(178,235,242,0.6); color: #004d40; }
    table.styled tbody tr:nth-child(even) { background: rgba(224,247,250,0.6); }
    details.toggle { background: rgba(178,235,242,0.45); border-radius: 18px; padding: 1rem 1.1rem; border: 1px solid rgba(128,222,234,0.6); }
    details.toggle summary { cursor: pointer; font-weight: 600; color: #006064; }
    canvas { max-width: 100%; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="page">
  <main class="container">
    <header class="hero">
      <h1>บทเรียนที่ 7: การแจกแจงเอกรูปไม่ต่อเนื่อง (Discrete Uniform)</h1>
      <p>เรียนรู้การแจกแจงที่ "ยุติธรรม" ที่สุด ทุกค่ามีโอกาสเท่ากัน ไม่ว่าจะสุ่มตัวเลขจากลูกเต๋า ไพ่ หรือเลขที่จับสลาก พร้อมสูตรลัดและกราฟโต้ตอบให้เห็นภาพแบบชัดเจน</p>
    </header>

    <section class="card" id="concept">
      <h2><span class="badge">Concept</span> ทุกผลลัพธ์มีสิทธิ์เท่ากัน</h2>
      <div class="grid two">
        <article class="definition">
          <strong>นิยาม</strong>
          <p>ตัวแปรสุ่ม X ที่มีค่าเป็น {1, 2, …, k} โดยที่ความน่าจะเป็นของทุกค่าคือ 1/k เรียกว่า <em>การแจกแจงเอกรูปไม่ต่อเนื่อง</em> (Discrete Uniform)</p>
          <div class="highlight">
            <ul>
              <li>ใช้ได้เมื่อสุ่ม <strong>โดยยุติธรรม</strong> ทุกค่าเกิดได้เท่ากัน</li>
              <li>เช่น ลูกเต๋า, การหยิบไพ่ 1 ใบ, การสุ่มหมายเลข</li>
            </ul>
          </div>
        </article>
        <article class="definition">
          <strong>สถานการณ์ที่พบบ่อย</strong>
          <ul>
            <li>สุ่มตัวเลขจาก 1 ถึง n โดยไม่โน้มเอียง</li>
            <li>สุ่มรหัสผ่านตัวเลข 0-9 (เลือก 1 ตัว)</li>
            <li>สุ่มชื่อจากรายชื่อที่จัดเรียงแบบอัตโนมัติ</li>
          </ul>
          <div class="pill-list">
            <span class="pill">Fair</span>
            <span class="pill">ทุกคนมีสิทธิ์</span>
            <span class="pill">โอกาสคงที่</span>
          </div>
        </article>
      </div>
    </section>

    <section class="card" id="formulas">
      <h2><span class="badge">Formulas</span> สูตรหลักจำให้ขึ้นใจ</h2>
      <div class="grid three">
        <article class="definition">
          <strong>ฟังก์ชันมวลความน่าจะเป็น (PMF)</strong>
          <div class="code-box">f(x) = P(X = x) = \frac{1}{k}\nสำหรับ x = 1,2,...,k</div>
          <p class="note">ทุกแท่งในกราฟสูงเท่ากัน</p>
        </article>
        <article class="definition">
          <strong>ค่าคาดหวัง</strong>
          <div class="code-box">E(X) = \frac{k + 1}{2}</div>
          <p class="note">ค่าเฉลี่ยคือกึ่งกลางของช่วง</p>
        </article>
        <article class="definition">
          <strong>ความแปรปรวน</strong>
          <div class="code-box">V(X) = \frac{k^2 - 1}{12}</div>
          <p class="note">ขึ้นกับจำนวนผลลัพธ์ทั้งหมด</p>
        </article>
      </div>
    </section>

    <section class="card" id="interactive">
      <h2><span class="badge">Playground</span> ปรับ k แล้วดูความเปลี่ยนแปลง</h2>
      <div class="calculator">
        <label for="k-slider">จำนวนผลลัพธ์ทั้งหมด (k): <strong id="k-value">6</strong></label>
        <input type="range" id="k-slider" min="2" max="20" value="6" />
        <label for="range-start">หาความน่าจะเป็นที่ X อยู่ระหว่าง</label>
        <div style="display:grid; gap:0.7rem; grid-template-columns: repeat(auto-fit, minmax(120px,1fr));">
          <input type="number" id="range-start" value="3" min="1" />
          <input type="number" id="range-end" value="5" min="1" />
        </div>
        <button id="prob-btn">คำนวณความน่าจะเป็นในช่วง</button>
      </div>
      <div id="summary-card" class="result-card" style="display:grid; margin-top:1.2rem;"></div>
      <div id="prob-card" class="result-card" style="margin-top:0.9rem;"></div>
      <div class="table-wrapper" id="pmf-table-wrapper">
        <table class="styled" id="pmf-table">
          <thead><tr><th>x</th><th>f(x)</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <canvas id="pmf-chart" height="240" style="margin-top:1.5rem;"></canvas>
    </section>

    <section class="card" id="example">
      <h2><span class="badge">Example</span> ทอดลูกเต๋า 1 ลูก</h2>
      <div class="grid two">
        <article class="definition">
          <strong>ให้ X = แต้มบนหน้าลูกเต๋า</strong>
          <div class="code-box">f(x) = 1/6 สำหรับ x = 1,...,6\nE(X) = (6+1)/2 = 3.5\nV(X) = (6^2 - 1)/12 = 35/12</div>
          <p class="note">ค่าเฉลี่ย 3.5 แม้จะไม่มีหน้าไหนเป็น 3.5 จริงๆ</p>
        </article>
        <article class="definition">
          <strong>คำถามน่าสนใจ</strong>
          <ul>
            <li>P(แต้มเป็นเลขคู่) = 3 × (1/6) = 0.5</li>
            <li>P(แต้ม ≥ 4) = 3 × (1/6) = 0.5</li>
            <li>ความแปรปรวนสูงขึ้นหากเพิ่มจำนวนหน้าของลูกเต๋า</li>
          </ul>
          <div class="highlight">
            <p>การแจกแจงเอกรูปไม่ต่อเนื่องเป็นฐานของการคำนวณความน่าจะเป็นพื้นฐานจำนวนมาก เช่น การสุ่มรหัสหรือการเลือกคนแบบเท่าเทียม</p>
          </div>
        </article>
      </div>
      <details class="toggle" style="margin-top:1.2rem;">
        <summary>ข้อควรจำ</summary>
        <ul>
          <li>หากข้อมูลไม่ได้ยุติธรรม (เช่น ลูกเต๋าเบี้ยว) จะไม่ใช่การแจกแจงเอกรูป</li>
          <li>ใช้ได้กับค่าที่แตกต่างกันแต่มีโอกาสเท่ากัน ไม่จำเป็นต้องเริ่มที่ 1 (สามารถปรับ shift ได้)</li>
          <li>เมื่อ k ใหญ่ขึ้น ค่าเฉลี่ยขยับไปกลางช่วงและความแปรปรวนเพิ่มตามสูตร</li>
        </ul>
      </details>
    </section>
  </main>

  <script>
    const kSlider = document.getElementById('k-slider');
    const kValue = document.getElementById('k-value');
    const summaryCard = document.getElementById('summary-card');
    const probCard = document.getElementById('prob-card');
    const pmfTableBody = document.querySelector('#pmf-table tbody');
    const rangeStart = document.getElementById('range-start');
    const rangeEnd = document.getElementById('range-end');
    const probBtn = document.getElementById('prob-btn');
    let pmfChart;

    function updateUniform(k) {
      kValue.textContent = k;
      const pmf = 1 / k;
      summaryCard.style.display = 'grid';
      summaryCard.innerHTML = `f(x) = 1/${k} = ${pmf.toFixed(4)} | E(X) = ${( (k + 1) / 2 ).toFixed(2)} | V(X) = ${(((k * k) - 1) / 12).toFixed(4)}`;

      pmfTableBody.innerHTML = '';
      const labels = [];
      const data = [];
      for (let i = 1; i <= k; i += 1) {
        labels.push(i);
        data.push(pmf);
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i}</td><td>${pmf.toFixed(4)}</td>`;
        pmfTableBody.appendChild(tr);
      }
      document.getElementById('pmf-table-wrapper').style.display = 'block';
      renderChart(labels, data);
    }

    function renderChart(labels, data) {
      const ctx = document.getElementById('pmf-chart');
      if (pmfChart) pmfChart.destroy();
      pmfChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: 'f(x)',
            data,
            backgroundColor: 'rgba(0,188,212,0.5)',
            borderColor: '#00838f',
            borderWidth: 1.5,
            borderRadius: 12
          }]
        },
        options: {
          plugins: { legend: { display: false } },
          scales: {
            x: { title: { display: true, text: 'ค่า x', color: '#006064' } },
            y: {
              beginAtZero: true,
              title: { display: true, text: 'Probability', color: '#006064' }
            }
          }
        }
      });
    }

    function calculateRangeProbability() {
      const k = parseInt(kSlider.value, 10);
      const start = Math.max(1, Math.min(parseInt(rangeStart.value, 10) || 1, k));
      const end = Math.max(start, Math.min(parseInt(rangeEnd.value, 10) || k, k));
      rangeStart.value = start;
      rangeEnd.value = end;
      const count = end - start + 1;
      const probability = count / k;
      probCard.style.display = 'grid';
      probCard.innerHTML = `P(${start} \u2264 X \u2264 ${end}) = ${count}/${k} = ${probability.toFixed(4)}`;
    }

    kSlider.addEventListener('input', () => {
      updateUniform(parseInt(kSlider.value, 10));
      calculateRangeProbability();
    });

    probBtn.addEventListener('click', calculateRangeProbability);

    updateUniform(parseInt(kSlider.value, 10));
    calculateRangeProbability();
  </script>
</body>
</html>
