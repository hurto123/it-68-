<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô, ‡πÅ‡∏ã‡∏°‡πÄ‡∏õ‡∏¥‡∏•‡∏™‡πÄ‡∏õ‡∏ã, ‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</title>
<!-- Site styles -->
<link href="../pwa/manifest.json" rel="manifest"/>
<link href="../styles/tokens.css" rel="stylesheet"/>
<link href="../styles/components.css" rel="stylesheet"/>
<link href="../styles/light.css" id="theme-link" rel="stylesheet"/><link href="../hotfix.css" rel="stylesheet"/>
<link href="../styles/typography-access.css" rel="stylesheet"/>
<link href="../styles/print.css" media="print" rel="stylesheet"/>
<style>
    main { max-width: 1100px; margin: 0 auto; padding: 2rem 1rem 6rem; }
    header.page-header { display: grid; gap:.5rem; margin-bottom: 1.25rem; }
    .pill { display:inline-block; padding:.2rem .6rem; border-radius:999px; background: var(--surface-3); font-size:.85rem; }
    .card { background: var(--surface-2); border:1px solid var(--surface-4); border-radius:16px; padding:1rem; box-shadow: var(--shadow-2); }
    .grid-2 { display:grid; grid-template-columns:1fr; gap:1rem; }
    @media (min-width: 900px){ .grid-2 { grid-template-columns:1fr 1fr; } }
    .svg-wrap { width:100%; overflow:auto; background: var(--surface-1); border:1px dashed var(--surface-4); border-radius:12px; padding:.75rem; }
    svg { max-width:100%; height:auto; }
    .controls { display:flex; flex-wrap:wrap; gap:.6rem; align-items:center; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background: var(--surface-4); padding: .1rem .35rem; border-radius: 6px; }
    .result { font-weight:700; }
    .toc { border-left:4px solid var(--surface-4); padding-left:.8rem; margin:1rem 0 2rem; line-height:1.7; }
    .toc a { display:block; color: var(--text-2); text-decoration:none; }
    .toc a:hover { color: var(--text-1); text-decoration:underline; }
    .print-actions { position: sticky; bottom: 1rem; display:flex; justify-content:flex-end; margin-top:1rem; }
    .btn { border-radius: 999px; padding: .55rem .9rem; border: 1px solid var(--surface-4); background: var(--surface-3); cursor: pointer; }
    .btn:hover { filter: brightness(1.03); }
    .callout { background: var(--surface-1); border-left:6px solid var(--accent-7); padding:.8rem 1rem; border-radius:12px; }
  </style>
<link href="../styles/skin-clean.css" rel="stylesheet"/></head>
<body class="skin-clean"><a class="skip-link" href="#main">‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</a>
<header class="site-header" role="banner">
<div class="brand">
<a class="brand-link" href="../index.html">üìä Prob &amp; Stats</a>
</div>
<nav aria-label="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠" class="site-actions">
<button class="btn-sm" id="theme-toggle" title="‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏° (T)">‡∏ò‡∏µ‡∏°</button>
<button class="btn-sm" id="print-current" title="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ (P)">‡∏û‡∏¥‡∏°‡∏û‡πå</button>
</nav>
</header>
<div aria-hidden="true" id="progressbar"><span></span></div>
<main id="main">
<nav aria-label="‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ" class="toc sticky" id="auto-toc">
<!-- will be populated by app.js -->
</nav><header class="page-header">
<div class="pill">üë®‚Äçüè´ ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 3</div>
<h1>‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô, ‡πÅ‡∏ã‡∏°‡πÄ‡∏õ‡∏¥‡∏•‡∏™‡πÄ‡∏õ‡∏ã, ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</h1>
<p class="muted">‡∏à‡∏≤‡∏Å ‚Äú‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‚Äù ‚Üí ‚Äú‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‚Äù : ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏° ‡πÅ‡∏ã‡∏°‡πÄ‡∏õ‡∏¥‡∏•‡∏™‡πÄ‡∏õ‡∏ã ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</p>
</header>
<nav class="toc">
<strong>‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç</strong>
<a href="#defs">1) ‡∏Ñ‡∏≥‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</a>
<a href="#prob-def">2) ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô</a>
<a href="#props">3) ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</a>
<a href="#examples">4) ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á + ‡∏Å‡∏£‡∏≤‡∏ü‡∏ö‡∏≤‡∏£‡πå (SVG)</a>
</nav>
<section class="card" id="defs">
<h2>1) ‡∏Ñ‡∏≥‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h2>
<ul>
<li><strong>‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏∏‡πà‡∏°</strong>: ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</li>
<li><strong>‡πÅ‡∏ã‡∏°‡πÄ‡∏õ‡∏¥‡∏•‡∏™‡πÄ‡∏õ‡∏ã (S)</strong>: ‡πÄ‡∏ã‡∏ï‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</li>
<li><strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå (E)</strong>: ‡πÄ‡∏ã‡∏ï‡∏¢‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á S ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏ô‡πÉ‡∏à</li>
</ul>
<div class="grid-2">
<div class="card">
<h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç</h3>
<p>S = {‡∏´‡∏±‡∏ß, ‡∏Å‡πâ‡∏≠‡∏¢}</p>
</div>
<div class="card">
<h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤</h3>
<p>S = {1,2,3,4,5,6}</p>
</div>
</div>
</section>
<section class="card" id="prob-def">
<h2>2) ‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô</h2>
<p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå E:</p>
<p class="kbd">P(E) = n(E) / n(S)</p>
<p class="muted">‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‚Äù / ‚Äú‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‚Äù</p>
<div class="card">
<h3>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì P(E) ‡πÅ‡∏ö‡∏ö‡πÇ‡∏ï‡πâ‡∏ï‡∏≠‡∏ö (‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏£‡∏á)</h3>
<div class="controls">
<label><input checked="" name="die" type="checkbox" value="1"/> 1</label>
<label><input name="die" type="checkbox" value="2"/> 2</label>
<label><input checked="" name="die" type="checkbox" value="3"/> 3</label>
<label><input name="die" type="checkbox" value="4"/> 4</label>
<label><input checked="" name="die" type="checkbox" value="5"/> 5</label>
<label><input name="die" type="checkbox" value="6"/> 6</label>
<button class="btn" id="calc-prob">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
</div>
<p>‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå E = ‡πÅ‡∏ï‡πâ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ  ‚áí  n(E) = <span class="result" id="nE">3</span>,  n(S) = <span class="result">6</span></p>
<p>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: P(E) = <span class="result" id="PE">0.5</span></p>
<div class="svg-wrap"><svg aria-label="‡∏Å‡∏£‡∏≤‡∏ü‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤" id="die-bars" role="img" viewbox="0 0 740 280"></svg></div>
<p class="muted">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏ï‡πâ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏Æ‡πÑ‡∏•‡∏ï‡πå‡∏ö‡∏≤‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå E (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‚Äî‡∏ß‡∏≤‡∏î‡∏î‡πâ‡∏ß‡∏¢ SVG)</p>
</div>
</section>
<section class="card" id="props">
<h2>3) ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h2>
<ul>
<li>0 ‚â§ P(E) ‚â§ 1</li>
<li>P(S) = 1</li>
<li><strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</strong> A‚à©B=‚àÖ ‚áí P(A‚à™B) = P(A) + P(B)</li>
</ul>
<div class="card">
<h3>‡∏™‡∏≤‡∏ò‡∏¥‡∏ï A‚à™B (‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô)</h3>
<div class="controls">
<label>A = {<input id="A" size="10" value="1,3,5"/>}</label>
<label>B = {<input id="B" size="10" value="2,4,6"/>}</label>
<button class="btn" id="calc-union">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
</div>
<p>n(A)=<span class="result" id="nA">3</span>, n(B)=<span class="result" id="nB">3</span>, n(A‚à™B)=<span class="result" id="nUnion">6</span></p>
<p>P(A)=<span class="result" id="PA">0.5</span>, P(B)=<span class="result" id="PB">0.5</span>, P(A‚à™B)=<span class="result" id="PUnion">1</span></p>
</div>
</section>
<section class="card" id="examples">
<h2>4) ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</h2>
<div class="grid-2">
<div class="card">
<h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 1: ‡πÅ‡∏ï‡πâ‡∏°‡∏Ñ‡∏µ‡πà</h3>
<p>E={1,3,5} ‚áí P(E)=3/6=0.5</p>
</div>
<div class="card">
<h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 2: ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•</h3>
<p>‡πÅ‡∏î‡∏á 5, ‡∏Ç‡∏≤‡∏ß 3 ‚áí P(‡πÅ‡∏î‡∏á)=5/8=0.625</p>
</div>
</div>
</section>
<div class="print-actions">
<button class="btn" id="print-current" title="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå</button>
</div>
</main>
<script src="../app.js"></script>
<script src="../i18n/i18n.js"></script>
<script>
  // ---------- Helpers ----------
  function uniqNumsInRange(arr) {
    const s = new Set();
    for (const x of arr) {
      const n = Number(x);
      if (Number.isFinite(n) && n>=1 && n<=6) s.add(n);
    }
    return Array.from(s).sort((a,b)=>a-b);
  }

  // ---------- Die Bars (SVG) ----------
  const dieSVG = document.getElementById("die-bars");
  const checkboxes = Array.from(document.querySelectorAll('input[name="die"]'));
  const nEEl = document.getElementById("nE");
  const PEEl = document.getElementById("PE");
  function renderBars() {
    const S = [1,2,3,4,5,6];
    const chosen = checkboxes.filter(c=>c.checked).map(c=>Number(c.value));
    const nE = chosen.length;
    nEEl.textContent = nE;
    PEEl.textContent = (nE/6).toFixed(3).replace(/\.0+$/,"");

    const width = 720, height = 240, pad=40;
    dieSVG.setAttribute("viewBox", "0 0 " + (width+pad) + " " + (height+pad));
    dieSVG.innerHTML = "";

    const barW = 80, gap = 30;
    const mkRect = (x,y,w,h,fill,stroke) => {
      const r = document.createElementNS("http://www.w3.org/2000/svg","rect");
      r.setAttribute("x",x); r.setAttribute("y",y);
      r.setAttribute("width",w); r.setAttribute("height",h);
      r.setAttribute("fill",fill); r.setAttribute("stroke",stroke||"var(--surface-4)");
      r.setAttribute("rx","8");
      dieSVG.appendChild(r);
      return r;
    };
    const mkText = (x,y,t,cls="") => {
      const el = document.createElementNS("http://www.w3.org/2000/svg","text");
      el.setAttribute("x",x); el.setAttribute("y",y);
      el.setAttribute("font-size","14"); el.setAttribute("fill","var(--text-2)");
      el.textContent = t; dieSVG.appendChild(el); return el;
    };

    // axes
    mkText(10, 16, "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô");
    mkText(width-20, height+30, "‡πÅ‡∏ï‡πâ‡∏°‡∏ö‡∏ô‡∏•‡∏π‡∏Å‡πÄ‡∏ï‡πã‡∏≤");

    for (let i=0;i<6;i++){
      const x = pad + i*(barW+gap);
      const isE = chosen.includes(i+1);
      const barH = 160; // equal probability
      const baseY = height - barH + 20;
      mkRect(x, baseY, barW, barH, isE ? "var(--accent-4)" : "var(--surface-2)");
      mkText(x+barW/2-4, baseY-6, "1/6");
      mkText(x+barW/2-4, height+18, String(i+1));
    }
  }
  document.getElementById("calc-prob").addEventListener("click", renderBars);
  checkboxes.forEach(cb => cb.addEventListener("change", renderBars));
  renderBars();

  // ---------- Disjoint Union ----------
  function parseSet(txt) {
    return uniqNumsInRange(txt.split(/\s*,\s*/));
  }
  function calcUnion() {
    const A = parseSet(document.getElementById("A").value);
    const B = parseSet(document.getElementById("B").value);
    const U = new Set([...A, ...B]);
    document.getElementById("nA").textContent = A.length;
    document.getElementById("nB").textContent = B.length;
    document.getElementById("nUnion").textContent = U.size;
    document.getElementById("PA").textContent = (A.length/6).toFixed(3).replace(/\.0+$/,"");
    document.getElementById("PB").textContent = (B.length/6).toFixed(3).replace(/\.0+$/,"");
    document.getElementById("PUnion").textContent = (U.size/6).toFixed(3).replace(/\.0+$/,"");
  }
  document.getElementById("calc-union").addEventListener("click", calcUnion);
  calcUnion();
  </script>
<footer class="site-footer" role="contentinfo">
<nav aria-label="‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡∏ö‡∏ó" class="prev-next">
<a class="btn-nav prev" href="02-descriptive.html" rel="prev">‚Üê ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏ö‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô (Counting Principles)</a>
<a class="btn-nav next" href="04-conditional.html" rel="next">üë®‚Äçüè´ ‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏Å‡∏é‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‚Üí</a>
</nav>
<p class="muted small">‡∏Å‡∏î <kbd>[</kbd> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö, <kbd>]</kbd> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏õ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ, <kbd>T</kbd> ‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏°, <kbd>P</kbd> ‡∏û‡∏¥‡∏°‡∏û‡πå</p>
</footer>
<!-- Fallback systems for content pages -->
<script>
  (function(){
    // Theme toggle & Print
    const themeLink = document.getElementById('theme-link');
    const themeBtn = document.getElementById('theme-toggle');
    const printBtn = document.getElementById('print-current');
    function toggleTheme(){
      if(!themeLink) return;
      const href = themeLink.getAttribute('href');
      if(href.includes('light.css')){
        themeLink.setAttribute('href', href.replace('light.css','theme-high-contrast.css'));
        localStorage.setItem('stats-theme','hc');
      }else if(href.includes('theme-high-contrast.css')){
        themeLink.setAttribute('href', href.replace('theme-high-contrast.css','light.css'));
        localStorage.setItem('stats-theme','light');
      }
    }
    try{
      const pref = localStorage.getItem('stats-theme');
      if(themeLink && pref==='hc' && themeLink.getAttribute('href').includes('light.css')){
        themeLink.setAttribute('href', themeLink.getAttribute('href').replace('light.css','theme-high-contrast.css'));
      }
    }catch(e){}
    themeBtn && themeBtn.addEventListener('click', toggleTheme);
    printBtn && printBtn.addEventListener('click', ()=>window.print());

    // Shortcuts
    document.addEventListener('keydown', (e)=>{
      if(e.key==='t' || e.key==='T') toggleTheme();
      if(e.key==='p' || e.key==='P') window.print();
      if(e.key==='['){ const a=document.querySelector('.prev-next a.prev[href]'); if(a){ e.preventDefault(); location.href=a.getAttribute('href'); } }
      if(e.key===']'){ const a=document.querySelector('.prev-next a.next[href]'); if(a){ e.preventDefault(); location.href=a.getAttribute('href'); } }
    });

    // Progress bar
    (function(){
      const bar = document.querySelector('#progressbar>span');
      if(!bar) return;
      const onScroll = ()=>{
        const el = document.scrollingElement || document.documentElement;
        const max = el.scrollHeight - el.clientHeight;
        const pct = max>0 ? (el.scrollTop/max)*100 : 0;
        bar.style.width = pct.toFixed(2)+'%';
      };
      document.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    })();

    // Build TOC from h2/h3
    (function(){
      const toc = document.getElementById('auto-toc');
      if(!toc) return;
      const heads = Array.from(document.querySelectorAll('main h2, main h3'));
      toc.innerHTML = '';
      heads.forEach((h,i)=>{
        if(!h.id){
          h.id = (h.textContent||('sec-'+i)).trim().toLowerCase().replace(/[^a-z0-9‡∏Å-‡πô]+/g,'-');
        }
        const a = document.createElement('a');
        a.href = '#'+h.id;
        a.textContent = h.textContent;
        if(h.tagName.toLowerCase()==='h3'){ a.style.paddingLeft = '1rem'; }
        toc.appendChild(a);
      });
      const links = Array.from(toc.querySelectorAll('a'));
      const obs = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            links.forEach(l=>l.classList.toggle('active', l.getAttribute('href')==='#'+e.target.id));
          }
        });
      }, {rootMargin:'0px 0px -70% 0px', threshold:.1});
      heads.forEach(h=>obs.observe(h));
    })();

    // Visited tracking
    (function(){
      try{
        var key = 'stats-visited';
        var href = location.pathname.split('/').slice(-2).join('/'); // content/NN-xxx.html
        var set = new Set(JSON.parse(localStorage.getItem(key) || '[]'));
        set.add(href);
        localStorage.setItem(key, JSON.stringify(Array.from(set)));
        localStorage.setItem('stats-last-lesson', JSON.stringify({ href, title: document.title, ts: Date.now() }));
      }catch(e){}
    })();

  })();
  </script>
<script>
(function(){
  const link = document.getElementById('theme-link');
  if(link && link.getAttribute('href').includes('theme-high-contrast.css')){
    link.setAttribute('href', link.getAttribute('href').replace('theme-high-contrast.css','light.css'));
  }
  try{ if(localStorage.getItem('stats-theme')==='hc'){ localStorage.removeItem('stats-theme'); } }catch(e){}
})();
</script>
<script defer="True" src="../hotfix.js"></script></body>
</html>
