<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏ö‡∏ó‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ó‡∏µ‡πà 6: ‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤ #1 - ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</title>
  <link rel="stylesheet" href="../styles/tokens.css">
  <link rel="stylesheet" href="../styles/components.css">
  <link rel="stylesheet" href="../styles/light.css">
  <link rel="stylesheet" href="../styles/typography-access.css">
  <link rel="stylesheet" href="../styles/print.css" media="print">
  <script defer src="../app.js"></script>
  <script defer src="../i18n/i18n.js"></script>
  <style>
    .lesson {
      display: grid;
      gap: var(--size-6);
      padding: var(--size-6);
    }
    .lesson .card {
      padding: var(--size-5);
    }
    .scenario {
      background: var(--surface-subtle);
      border-radius: var(--radius-md);
      padding: var(--size-4);
      border-left: 4px solid var(--accent-strong);
    }
    .lab {
      display: grid;
      gap: var(--size-4);
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      align-items: start;
    }
    .lab label {
      display: flex;
      flex-direction: column;
      gap: var(--size-2);
      font-weight: 600;
    }
    .lab input,
    .lab select,
    .lab button {
      padding: var(--size-2);
      border-radius: var(--radius-sm);
      border: 1px solid var(--border-muted);
      font: inherit;
    }
    .lab button {
      cursor: pointer;
      background: var(--accent-muted);
      color: var(--accent-strong);
      border: none;
      font-weight: 600;
    }
    .lab canvas {
      width: 100%;
      height: 240px;
      border-radius: var(--radius-md);
      background: var(--surface-muted);
    }
    .results {
      display: grid;
      gap: var(--size-2);
      padding: var(--size-3);
      background: var(--surface-subtle);
      border-radius: var(--radius-md);
    }
    @media print {
      .lesson {
        padding: 0;
      }
    }
  </style>
</head>
<body data-page="review">
  <header class="site-header">
    <div>
      <p class="eyebrow">üë®‚Äçüè´ ‡∏ö‡∏ó‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏ó‡∏µ‡πà 6</p>
      <h1>‡∏Å‡∏£‡∏ì‡∏µ‡∏®‡∏∂‡∏Å‡∏©‡∏≤ #1 - ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</h1>
      <p class="subtitle">‡∏™‡∏ß‡∏°‡∏ö‡∏ó‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á Gemini Coffee</p>
    </div>
    <nav class="header-actions">
      <a class="ghost" href="../index.html#review">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ</a>
      <button id="print-current" class="ghost">‡∏û‡∏¥‡∏°‡∏û‡πå</button>
    </nav>
  </header>
  <main class="lesson">
    <article class="card flow">
      <div class="scenario">
        <h2>‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏™‡∏°‡∏°‡∏ï‡∏¥</h2>
        <p>‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü‡πÅ‡∏´‡πà‡∏á‡πÉ‡∏´‡∏°‡πà "Gemini Coffee" ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏°‡∏≤ 25 ‡∏Ñ‡∏ô (n=25) ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
        <ul>
          <li>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (\(\bar{x}\)): 140 ‡∏ö‡∏≤‡∏ó</li>
          <li>‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (s): 20 ‡∏ö‡∏≤‡∏ó</li>
        </ul>
      </div>
    </article>

    <article class="card flow">
      <h2>‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏£‡∏¥‡∏á)</h2>
      <p><strong>‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:</strong> ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á (Œº) ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà?</p>
      <ol>
        <li><strong>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠:</strong> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô 95% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Œº</li>
        <li><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠:</strong> ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö œÉ ‡πÅ‡∏•‡∏∞ n ‡πÄ‡∏•‡πá‡∏Å (25) ‡∏à‡∏∂‡∏á‡πÉ‡∏ä‡πâ t-Distribution</li>
        <li><strong>‡∏Ñ‡πà‡∏≤‡∏ß‡∏¥‡∏Å‡∏§‡∏ï:</strong> df = 24, t<sub>critical</sub> = 2.064</li>
        <li><strong>‡∏™‡∏π‡∏ï‡∏£:</strong> \(CI = 140 ¬± 2.064 (20/\sqrt{25}) = 140 ¬± 8.256\)</li>
        <li><strong>‡∏™‡∏£‡∏∏‡∏õ:</strong> ‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠ (131.74, 148.26)</li>
      </ol>
      <p><em>‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°:</em> ‡πÄ‡∏£‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô 95% ‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 131.74 ‚Äì 148.26 ‡∏ö‡∏≤‡∏ó</p>
    </article>

    <article class="card flow">
      <h2>‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏û‡∏≤‡∏Å‡∏©‡∏≤ (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏≠‡πâ‡∏≤‡∏á)</h2>
      <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:</strong> ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≤‡∏Ç‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡πâ‡∏≤‡∏á‡∏ß‡πà‡∏≤ "‡∏£‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡πÅ‡∏ü‡πÅ‡∏ñ‡∏ß‡∏ô‡∏µ‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏Ñ‡πà 130 ‡∏ö‡∏≤‡∏ó" ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏ô Gemini Coffee ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 130 ‡∏ö‡∏≤‡∏ó‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà</p>
      <ol>
        <li>‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ê‡∏≤‡∏ô: H<sub>0</sub>: Œº = 130, H<sub>1</sub>: Œº &gt; 130 (‡∏´‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤)</li>
        <li>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: Œ± = 0.05</li>
        <li>‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏î‡∏™‡∏≠‡∏ö: \(t = \dfrac{140 - 130}{20/\sqrt{25}} = 2.5\)</li>
        <li>p-value ‚âà 0.01</li>
        <li>‡∏™‡∏£‡∏∏‡∏õ: p-value &lt; Œ± ‚Üí ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò H<sub>0</sub>; ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ 130 ‡∏ö‡∏≤‡∏ó‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</li>
      </ol>
    </article>

    <article class="card flow">
      <h2>One-Sample Analysis Lab</h2>
      <p>‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö t ‡πÅ‡∏ö‡∏ö‡∏™‡∏î‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏ú‡∏ô‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏†‡∏≤‡∏û‡∏ô‡∏¥‡πà‡∏á)</p>
      <div class="lab">
        <div class="control flow">
          <label for="lab-mean">\(\bar{x}\) (‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
            <input type="number" id="lab-mean" value="140" step="0.1">
          </label>
          <label for="lab-sd">s (‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô)
            <input type="number" id="lab-sd" value="20" step="0.1">
          </label>
          <label for="lab-n">n (‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
            <input type="number" id="lab-n" value="25" min="2">
          </label>
          <label for="lab-mu0">Œº<sub>0</sub> (‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡πâ‡∏≤‡∏á)
            <input type="number" id="lab-mu0" value="130" step="0.1">
          </label>
          <label for="lab-confidence">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏±‡πà‡∏ô (%)
            <input type="number" id="lab-confidence" value="95" min="50" max="99.9" step="0.1">
          </label>
          <label for="lab-alpha">Œ± (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö)
            <input type="number" id="lab-alpha" value="0.05" min="0.001" max="0.2" step="0.001">
          </label>
          <div class="results" aria-live="polite">
            <p><strong>CI:</strong> <span id="lab-ci">(0, 0)</span></p>
            <p><strong>t:</strong> <span id="lab-t">0.00</span></p>
            <p><strong>p-value (‡∏´‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß):</strong> <span id="lab-p">0.000</span></p>
            <p><strong>‡∏Ñ‡∏≥‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô:</strong> <span id="lab-verdict">‡∏¢‡∏±‡∏á‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò H<sub>0</sub> ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</span></p>
          </div>
        </div>
        <canvas id="one-sample-chart" role="img" aria-label="‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö t"></canvas>
      </div>
    </article>
  </main>
  <footer class="site-footer">
    <p>¬© 2024 Stats Learning Lab</p>
    <a class="ghost" href="../index.html">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
  </footer>
  <script>
    const oneCanvas = document.getElementById('one-sample-chart');
    const oneCtx = oneCanvas.getContext('2d');
    const meanInput = document.getElementById('lab-mean');
    const sdInput = document.getElementById('lab-sd');
    const nInput = document.getElementById('lab-n');
    const mu0Input = document.getElementById('lab-mu0');
    const confInput = document.getElementById('lab-confidence');
    const alphaInput = document.getElementById('lab-alpha');
    const ciLabel = document.getElementById('lab-ci');
    const tLabel = document.getElementById('lab-t');
    const pLabel = document.getElementById('lab-p');
    const verdictLabel = document.getElementById('lab-verdict');

    function resizeOneCanvas() {
      const ratio = window.devicePixelRatio || 1;
      const width = oneCanvas.clientWidth;
      const height = oneCanvas.clientHeight;
      oneCanvas.width = width * ratio;
      oneCanvas.height = height * ratio;
      oneCtx.setTransform(1, 0, 0, 1, 0, 0);
      oneCtx.scale(ratio, ratio);
    }

    function inverseNormalCDF(p) {
      return Math.sqrt(2) * invErf(2 * p - 1);
    }

    function invErf(x) {
      const a = 0.147;
      const ln = Math.log(1 - x * x);
      const term1 = 2 / (Math.PI * a) + ln / 2;
      const term2 = ln / a;
      return Math.sign(x) * Math.sqrt(Math.sqrt(term1 * term1 - term2) - term1);
    }

    function tCritical(df, alpha) {
      const z = inverseNormalCDF(1 - alpha / 2);
      const correction = (z ** 3 + z) / (4 * df);
      return z + correction;
    }

    function tCDF(t, df) {
      // use approximate relation via incomplete beta
      const x = df / (df + t * t);
      const beta = incompleteBeta(df / 2, 0.5, x);
      if (t >= 0) {
        return 1 - 0.5 * beta;
      }
      return 0.5 * beta;
    }

    function incompleteBeta(a, b, x) {
      if (x <= 0) return 0;
      if (x >= 1) return 1;
      const bt = Math.exp(logGamma(a + b) - logGamma(a) - logGamma(b) + a * Math.log(x) + b * Math.log(1 - x));
      if (x < (a + 1) / (a + b + 2)) {
        return bt * betacf(a, b, x) / a;
      }
      return 1 - bt * betacf(b, a, 1 - x) / b;
    }

    function betacf(a, b, x) {
      const maxIterations = 200;
      const epsilon = 3e-7;
      let qab = a + b;
      let qap = a + 1;
      let qam = a - 1;
      let c = 1;
      let d = 1 - qab * x / qap;
      if (Math.abs(d) < 1e-30) d = 1e-30;
      d = 1 / d;
      let h = d;
      for (let m = 1; m <= maxIterations; m += 1) {
        const m2 = 2 * m;
        let aa = m * (b - m) * x / ((qam + m2) * (a + m2));
        d = 1 + aa * d;
        if (Math.abs(d) < 1e-30) d = 1e-30;
        c = 1 + aa / c;
        if (Math.abs(c) < 1e-30) c = 1e-30;
        d = 1 / d;
        h *= d * c;
        aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));
        d = 1 + aa * d;
        if (Math.abs(d) < 1e-30) d = 1e-30;
        c = 1 + aa / c;
        if (Math.abs(c) < 1e-30) c = 1e-30;
        d = 1 / d;
        const del = d * c;
        h *= del;
        if (Math.abs(del - 1) < epsilon) {
          break;
        }
      }
      return h;
    }

    function logGamma(z) {
      const x = [0.99999999999980993, 676.5203681218851, -1259.1392167224028,
        771.32342877765313, -176.61502916214059, 12.507343278686905,
        -0.13857109526572012, 9.9843695780195716e-6, 1.5056327351493116e-7];
      let y = z;
      let tmp = z + 7.5;
      tmp = (z + 0.5) * Math.log(tmp) - tmp;
      let ser = x[0];
      for (let i = 1; i < x.length; i += 1) {
        ser += x[i] / (y + i);
      }
      return tmp + Math.log(2.5066282746310005 * ser / z);
    }

    function updateLab() {
      const mean = Number(meanInput.value);
      const sd = Math.max(0.0001, Number(sdInput.value));
      const n = Math.max(2, Number(nInput.value));
      const mu0 = Number(mu0Input.value);
      const confidence = Math.min(0.999, Math.max(0.5, Number(confInput.value) / 100));
      const alpha = Number(alphaInput.value);
      const df = n - 1;
      const se = sd / Math.sqrt(n);
      const critical = tCritical(df, 1 - confidence);
      const margin = critical * se;
      const lower = mean - margin;
      const upper = mean + margin;
      const tStatistic = (mean - mu0) / se;
      const pValue = 1 - tCDF(tStatistic, df);
      const reject = pValue <= alpha;

      ciLabel.textContent = `(${lower.toFixed(2)}, ${upper.toFixed(2)})`;
      tLabel.textContent = tStatistic.toFixed(3);
      pLabel.textContent = pValue.toFixed(4);
      verdictLabel.textContent = reject ? '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò H‚ÇÄ' : '‡∏¢‡∏±‡∏á‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò H‚ÇÄ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ';
      verdictLabel.style.color = reject ? 'var(--critical-strong, #c1121f)' : 'var(--text-strong, #111)';

      drawTChart(tStatistic, df, alpha);
    }

    function drawTChart(tStatistic, df, alpha) {
      const width = oneCanvas.clientWidth;
      const height = oneCanvas.clientHeight;
      const ratio = window.devicePixelRatio || 1;
      oneCtx.setTransform(ratio, 0, 0, ratio, 0, 0);
      oneCtx.clearRect(0, 0, oneCanvas.width, oneCanvas.height);

      const padding = 36;
      const start = -4;
      const end = 4;
      const steps = 200;
      const xScale = (width - padding * 2) / (end - start);
      const yScale = (height - padding * 2) / 0.45;

      oneCtx.strokeStyle = 'var(--border-muted, #c7d0ff)';
      oneCtx.beginPath();
      oneCtx.moveTo(padding, height - padding);
      oneCtx.lineTo(width - padding / 2, height - padding);
      oneCtx.stroke();

      oneCtx.beginPath();
      for (let i = 0; i <= steps; i += 1) {
        const x = start + (i / steps) * (end - start);
        const y = normalPdf(x);
        const canvasX = padding + (x - start) * xScale;
        const canvasY = height - padding - y * yScale;
        if (i === 0) {
          oneCtx.moveTo(canvasX, canvasY);
        } else {
          oneCtx.lineTo(canvasX, canvasY);
        }
      }
      oneCtx.strokeStyle = 'var(--accent-strong, #4a63e7)';
      oneCtx.lineWidth = 2;
      oneCtx.stroke();

      const crit = inverseNormalCDF(1 - alpha);
      const critX = padding + (crit - start) * xScale;
      oneCtx.fillStyle = 'var(--critical-strong, #c1121f)';
      oneCtx.fillRect(critX - 2, height - padding - 140, 4, 120);
      oneCtx.fillText(`critical ‚âà ${crit.toFixed(2)}`, critX - 36, padding + 12);

      const statX = padding + (tStatistic - start) * xScale;
      oneCtx.fillStyle = 'var(--text-strong, #111)';
      oneCtx.fillRect(statX - 2, height - padding - 160, 4, 160);
      oneCtx.fillText(`t = ${tStatistic.toFixed(2)}`, statX - 24, padding + 24);
    }

    function normalPdf(x) {
      return (1 / Math.sqrt(2 * Math.PI)) * Math.exp(-0.5 * x * x);
    }

    [meanInput, sdInput, nInput, mu0Input, confInput, alphaInput].forEach((el) => el.addEventListener('input', updateLab));

    resizeOneCanvas();
    window.addEventListener('resize', () => {
      resizeOneCanvas();
      updateLab();
    });

    updateLab();
  </script>
</body>
</html>
